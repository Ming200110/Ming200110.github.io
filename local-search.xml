<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>用预训练的卷积神经网络完成色彩风格迁移</title>
    <link href="/2024/05/04/styleTransfer/"/>
    <url>/2024/05/04/styleTransfer/</url>
    
    <content type="html"><![CDATA[<html><script>MathJax = {  loader: {    load: ['[tex]/physics']  },  tex: {    packages: {'[+]': ['physics']}  }};</script><script id="MathJax-script" async  src="https://cdnjs.loli.net/ajax/libs/mathjax/3.0.1/es5/tex-mml-chtml.js"></script></html><h1id="用预训练的卷积神经网络完成色彩风格迁移">用预训练的卷积神经网络完成色彩风格迁移</h1><p>摄影爱好者也许接触过滤波器。它能改变照片的颜色风格，从而使风景照更加锐利或者令人像更加美白。但一个滤波器通常只能改变照片的某个方面。如果要照片达到理想中的风格，可能需要尝试大量不同的组合。这个过程的复杂程度不亚于模型调参。</p><figure><img src="style_transfer2.png"alt="输入内容图像和风格图像，输出风格迁移后的合成图像" /><figcaptionaria-hidden="true">输入内容图像和风格图像，输出风格迁移后的合成图像</figcaption></figure><h2 id="卷积神经网络简介">卷积神经网络简介</h2><p>卷积神经网络 (Convolutional Neural Network, CNN)是一种深度学习模型，特别适用于处理具有网格结构的数据，如图像和视频。 CNN主要由卷积层 (Convolutional Layer)、池化层 (Pooling Layer)、激活函数(Activation Function) 和全连接层 (Fully Connected Layer) 组成。</p><p>在 CNN中，卷积层通过卷积操作提取输入数据的特征，池化层通过降采样操作减小特征图的大小，激活函数引入非线性因素，全连接层将提取的特征映射到输出类别。整个网络通过反向传播算法进行训练，优化网络参数以最小化损失函数。</p><p>CNN的特点包括参数共享、局部感受野和空间层次结构，使其在图像处理任务中表现出色。通过多层卷积和池化操作，CNN能够逐渐学习到输入数据的高级特征表示，从而实现图像分类、目标检测、图像分割等任务。</p><p>CNN 的数学原理涉及卷积操作、池化操作、激活函数等，其中卷积操作是 CNN的核心部分。卷积操作可以用数学公式表示为: <span class="math display">\[    \text{Conv}(I, K) = I * K\]</span> 其中，<span class="math inline">\(I\)</span>表示输入特征图，<span class="math inline">\(K\)</span> 表示卷积核(滤波器)，<span class="math inline">\(*\)</span>表示卷积操作。卷积操作通过滑动卷积核在输入特征图上提取特征，实现特征的局部连接和参数共享。</p><p>总的来说，CNN是一种强大的深度学习模型，在图像处理领域有着广泛的应用，并且在许多其他领域也取得了成功。</p><h2 id="vgg19-简介">VGG19 简介</h2><p>VGG19 是一种深度卷积神经网络模型，属于 VGG (Visual Geometry Group)系列之一。 该模型由牛津大学的研究团队开发，用于图像分类和识别任务。VGG19的名称中的 “19” 表示该模型具有 19 层神经网络，包括 16 个卷积层和 3个全连接层。</p><p>VGG19 的架构相对简单而经典，采用了连续多个 <spanclass="math inline">\(3 \times 3\)</span> 的卷积核和 <spanclass="math inline">\(2 \times 2\)</span> 的最大池化层，以及 Relu激活函数。 这种深层的架构使得 VGG19能够学习到更加复杂和抽象的特征，从而在图像分类等任务中表现出色。</p><p>VGG19模型在图像识别领域取得了很好的表现，并被广泛用于迁移学习和特征提取。它的预训练模型通常基于大规模图像数据集(如 ImageNet) 进行训练， 可以在各种计算机视觉任务中发挥作用。</p><h3id="代码实现选择训练设备并设置-vgg-中参数">代码实现：选择训练设备并设置VGG 中参数</h3><p>使用 PyTorch 中的 models.vgg19 函数加载预训练的 VGG19模型，并将其特征提取部分 features 移动到指定的设备 device 上进行计算，并将 vgg 模型中的参数的梯度设置为不需要计算，即不进行梯度更新。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim<br><span class="hljs-keyword">from</span> torchvision <span class="hljs-keyword">import</span> models, transforms<br><span class="hljs-keyword">from</span> torchvision.models <span class="hljs-keyword">import</span> VGG19_Weights<br><br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br><span class="hljs-comment"># 选择设备</span><br>device = torch.device(<span class="hljs-string">&quot;cuda:0&quot;</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;cpu&quot;</span>)<br><span class="hljs-comment"># 使用 PyTorch 中的 models.vgg19 函数加载预训练的 VGG19 模型，并将其特征提取部分 features 移动到指定的设备 device 上进行计算</span><br>vgg = models.vgg19(weights=VGG19_Weights.IMAGENET1K_V1).features.to(device)<br><br><span class="hljs-comment"># 将 vgg 模型中的参数的梯度设置为不需要计算，即不进行梯度更新</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> vgg.parameters():<br>    i.requires_grad_(<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><h2 id="载入内容图片与风格图片">载入内容图片与风格图片</h2><p>在使用 torchvision.transforms进行数据处理时我们经常进行的操作是：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 定义读入与处理图片的函数</span><br><br>MIX_SIZE = <span class="hljs-number">500</span> <span class="hljs-comment"># 设定图像最大尺寸</span><br><br>rgb_mean = (<span class="hljs-number">0.485</span>, <span class="hljs-number">0.456</span>, <span class="hljs-number">0.406</span>)<br>rgb_std = (<span class="hljs-number">0.229</span>, <span class="hljs-number">0.224</span>, <span class="hljs-number">0.225</span>)<br></code></pre></td></tr></table></figure><p>第 5 行代码 (0.485,0.456,0.406) 表示均值，分别对应的是 RGB三个通道；第 6 行代码 (0.229,0.224,0.225) 则表示的是标准差。均值和标准差的值由 ImageNet 数据集计算得出。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_img</span>(<span class="hljs-params">path, max_size=MIX_SIZE, shape=<span class="hljs-literal">None</span></span>):<br>    img = Image.<span class="hljs-built_in">open</span>(path).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">max</span>(img.size) &gt; max_size:<br>        size = max_size<br>    <span class="hljs-keyword">else</span>:<br>        size = <span class="hljs-built_in">max</span>(img.size)<br><br>    <span class="hljs-keyword">if</span> shape <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        size = shape<br>    <br>    transform = transforms.Compose(<br>        [<br>            transforms.Resize(size),<br>            transforms.ToTensor(),<br>            transforms.Normalize(mean=rgb_mean, std=rgb_std)<br>        ]<br>    )<br>    <span class="hljs-comment"># 删除 alpha 通道 jpg，转为 png，并补足另一维度 batch</span><br>    img = transform(img)[:<span class="hljs-number">3</span>, :, :].unsqueeze(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span> img.to(device)<br><span class="hljs-comment"># 载入图像</span><br>content = load_img(<span class="hljs-string">&quot;./style_transfer/IMG_20230414_183148.jpg&quot;</span>)<br>style = load_img(<br>    <span class="hljs-string">&quot;./style_transfer/style.jpg&quot;</span>, shape=content.shape[-<span class="hljs-number">2</span>:]<br>)  <span class="hljs-comment"># 让两张图尺寸一样</span><br></code></pre></td></tr></table></figure><h3id="代码实现将-pytorch-张量转换为表示图像的-numpy-数组的函数">代码实现：将PyTorch 张量转换为表示图像的 NumPy 数组的函数</h3><p>将 PyTorch 张量移动到 CPU 上，然后转换为 NumPy 数组，并通过 squeeze()方法去除维度为 1 的维度，以简化数组的形状；然后，转置数组的维度，将通道维度移动到最后一个维度，以匹配图像的通道顺序，并对图像进行归一化处理，通过乘以标准差并加上均值来反向转换图像数据；最后，将图像像素值截断到范围 [0, 1]，确保图像数据在有效范围内。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 将 PyTorch 张量转换为表示图像的 NumPy 数组的函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">im_convert</span>(<span class="hljs-params">tensor</span>):<br>    <span class="hljs-comment"># 创建输入张量的副本，并且将其从计算图中分离，确保不会影响原始张量的梯度计算</span><br>    img = tensor.clone().detach()<br>    <span class="hljs-comment"># 将 PyTorch 张量移动到 CPU 上，然后转换为 NumPy 数组，并通过 squeeze() 方法去除维度为 1 的维度，以简化数组的形状</span><br>    img = img.cpu().numpy().squeeze()<br>    <span class="hljs-comment"># 转置数组的维度，将通道维度移动到最后一个维度，以匹配图像的通道顺序</span><br>    img = img.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-comment"># 对图像进行归一化处理，通过乘以标准差并加上均值来反向转换图像数据</span><br>    img = img * np.array(rgb_std) + np.array(rgb_mean)<br>    <span class="hljs-comment"># 将图像像素值截断到范围 [0, 1]，确保图像数据在有效范围内</span><br>    img = img.clip(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> img<br></code></pre></td></tr></table></figure><h3id="代码实现将网络层层的输出存入-feature-数组">代码实现：将网络层层的输出存入feature 数组</h3><p>这段代码是一个函数，名为get_features，它用于将给定图像在神经网络模型中经过指定层的输出存储到一个名为features 的字典中，并返回该字典。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 将网络层层的输出存入 feature 数组中，并返回</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_features</span>(<span class="hljs-params">img, model, layers=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> layers <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        layers = &#123;<br>            <span class="hljs-string">&quot;0&quot;</span>: <span class="hljs-string">&quot;conv1_1&quot;</span>,<br>            <span class="hljs-string">&quot;5&quot;</span>: <span class="hljs-string">&quot;conv2_1&quot;</span>,<br>            <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;conv3_1&quot;</span>,<br>            <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;conv4_1&quot;</span>,<br>            <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;conv4_2&quot;</span>,  <span class="hljs-comment"># content 层所需</span><br>            <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;conv5_1&quot;</span>,<br>        &#125;<br><br>    features = &#123;&#125;<br>    x = img<br>    <span class="hljs-keyword">for</span> name, layer <span class="hljs-keyword">in</span> model._modules.items():<br>        x = layer(x)<br>        <span class="hljs-keyword">if</span> name <span class="hljs-keyword">in</span> layers:<br>            features[layers[name]] = x<br><br>    <span class="hljs-keyword">return</span> features<br></code></pre></td></tr></table></figure><p>函数接受三个参数: img 代表输入的图像数据，model代表神经网络模型，layers 是一个字典，用于指定要提取特征的层。 如果未指定layers，则会使用默认的层次对应关系。</p><p>函数首先创建一个空字典 features 用于存储特征。然后，对输入图像 img进行前向传播计算，通过遍历模型的各个层， 将每一层的输出存储到 features字典中，键为层的名称，值为该层的输出。</p><p>最后，函数返回存储有指定层输出的 features 字典。</p><h2 id="gram-矩阵">Gram 矩阵</h2><p>设提取内容的模型为 <spanclass="math inline">\(f_c\)</span>，输入图像的矩阵为 <spanclass="math inline">\(\vb*{X}\)</span>，内容图像的矩阵为 <spanclass="math inline">\(\vb*{C}\)</span>，我们直接用平方误差作为内容上的损失:<span class="math display">\[    L_c(\vb*{X})=\dfrac{1}{2}\norm{f_c(\vb*{X})-f_c(\vb*{C})}^2_F\]</span>相比于内容，图像的风格更难描述，也更不容易直接得到。直观上说，一幅图像的风格值的是图像的色彩、纹理等要素，这些要素在每个尺度上都有体现。因此，我们考虑同一个卷积层中由不同的卷积核提取的特征。由于这些特征属于同一层，因此基本属于原图中的相同尺度。那么它们之间的相关性可以一定程度上反映图像在该尺度上的风格特点。</p><p>设某一层中卷积核是数量为 <spanclass="math inline">\(N\)</span>，每个卷积核与输入运算得到的输出大小为<span class="math inline">\(M\)</span>，其中 <spanclass="math inline">\(M\)</span> 表示输出矩阵中元素的总数量。那么，该卷积层中的总特征矩阵 <spanclass="math inline">\(\vb*{F}\in\mathbb{R}^{N\timesM}\)</span>，每一行向量都表示一个卷积核输出的特征。</p><p>为了表示不同特征之间的关系，我们使用与因子分解机类似的思想，将特征之间做内积，得到<span class="math display">\[    \vb*{G}=\vb*{FF}^\top\]</span> 该矩阵为格拉姆矩阵 (Gram matrix)，矩阵 <spanclass="math inline">\(\vb*{G}\in\mathbb{R}^{N\times N}\)</span>在计算乘积的过程中，把与特征在图像中的位置有关的维度消掉了，只保留了与卷积核有关的维度。直观上说，这体现了图像的风格特征与其相对位置无关，是图像的全局属性。</p><p>设由第 <span class="math inline">\(i\)</span>个卷积层提取的输入图像的风格矩阵为 <spanclass="math inline">\(\vb*{G}_X^{(x)}\)</span>，风格图像的风格矩阵为<spanclass="math inline">\(\vb*{G}_S^{(i)}\)</span>，我们同样用平方误差作为损失函数:<span class="math display">\[    L_S^{(i)}(\vb*{X})=\dfrac{1}{4N_{(i)}^2M_{(i)}^2}\norm{\vb*{G}_{X}^{(i)}-\vb*{G}_{S}^{(i)}}^2_F\]</span> 这里，由于不同卷积层的参数可能不同，我们额外除以 <spanclass="math inline">\(4N_{(i)}^2M_{(i)}^2\)</span>来进行层间的归一化。</p><p>最后，再用权重 <span class="math inline">\(w_i\)</span>对不同卷积层的损失做加权平均，得到总的风格损失为: <spanclass="math display">\[    L_S(\vb*{X})=\sum_{i}w_iL_S^{(i)}(\vb*{X})\]</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 输出 Gram Matrix</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gram_matrix</span>(<span class="hljs-params">tensor</span>):<br>    <span class="hljs-comment"># d 表示通道数，h 表示高度，w 表示宽度。</span><br>    _, d, h, w = tensor.size()  <span class="hljs-comment"># 第一个是 batch_size</span><br><br>    <span class="hljs-comment"># 将张量重新调整形状为 (d, h*w)，即将每个通道的特征图展平为一维向量</span><br>    tensor = tensor.view(d, h * w)<br>    gram = torch.mm(tensor, tensor.t())<br><br>    <span class="hljs-keyword">return</span> gram<br></code></pre></td></tr></table></figure><h2 id="内容特征与风格特征提取">内容特征与风格特征提取</h2><p>首先通过 get_features 函数分别获取内容图像 content 和风格图像 style在 VGG 模型中各层的特征表示， 分别存储在 content_features 和style_features 字典中。</p><p>使用字典推导式遍历 style_features字典中的每一层，对每一层的特征张量计算 Gram 矩阵，并将结果存储在style_grams 字典中。</p><p>在字典推导式中，对于每个 layer，调用 gram_matrix 函数计算其对应的Gram 矩阵，将结果存储在 style_grams 字典中，键为层名，值为对应层的 Gram矩阵。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">content_features = get_features(img=content, model=vgg)<br>style_features = get_features(img=style, model=vgg)<br><span class="hljs-string">&#x27;&#x27;&#x27; 使用字典推导式，遍历 style_features 字典中的每一层，</span><br><span class="hljs-string">    对每一层的特征张量计算 Gram 矩阵，并将结果存储在 style_grams 字典中，</span><br><span class="hljs-string">    键为层名，值为对应层的 Gram 矩阵&#x27;&#x27;&#x27;</span><br>style_grams = &#123;<br>    layer: gram_matrix(tensor=style_features[layer]) <span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> style_features<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="代码实现定义优化目标与权重">代码实现：定义优化目标与权重</h3><p>target = content.clone().requires_grad_(True): 创建了一个与内容图像content 相同的张量 target，并设置其可导，用于后续的优化过程。</p><p>style_weights:定义了不同层的权重，指定了每个层对风格损失的贡献权重。</p><p>content_weight = 1: 内容损失的权重，用于控制内容重建的贡献程度。</p><p>style_weight = 1e4:风格损失的权重，用于控制风格重建的贡献程度。通常风格损失的权重会设置得比较大，以确保风格特征能够有效地传递到生成的图像中。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 定义优化目标</span><br>target = content.clone().requires_grad_(<span class="hljs-literal">True</span>)<br><br><span class="hljs-comment"># 定义不同层的权重</span><br>style_weights = &#123;<br>    <span class="hljs-string">&quot;conv1_1&quot;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;conv2_1&quot;</span>: <span class="hljs-number">0.8</span>,<br>    <span class="hljs-string">&quot;conv3_1&quot;</span>: <span class="hljs-number">0.5</span>,<br>    <span class="hljs-string">&quot;conv4_1&quot;</span>: <span class="hljs-number">0.3</span>,<br>    <span class="hljs-string">&quot;conv5_1&quot;</span>: <span class="hljs-number">0.1</span>,<br>&#125;<br><br><span class="hljs-comment"># 定义两种损失对应的权重</span><br>content_weight = <span class="hljs-number">1</span><br>style_weight =<span class="hljs-number">1e4</span><br></code></pre></td></tr></table></figure><h2 id="训练模型">训练模型</h2><p>在训练模型进行风格迁移时，我们不断抽取合成图像的内容特征和风格特征，然后计算损失函数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 开始训练</span><br><span class="hljs-comment"># 每 20% 输出一次训练结果</span><br>show_every = <span class="hljs-number">2000</span><br>epoch = <span class="hljs-number">20000</span><br>optimizer = optim.Adam([target], lr=<span class="hljs-number">0.003</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(epoch)):<br>    target_features = get_features(img=target, model=vgg)<br>    <span class="hljs-comment"># 计算内容损失，即目标图像与内容图像在特定层的特征之间的均方误差</span><br>    content_loss = torch.mean(<br>        (target_features[<span class="hljs-string">&quot;conv4_2&quot;</span>] - content_features[<span class="hljs-string">&quot;conv4_2&quot;</span>]) ** <span class="hljs-number">2</span><br>    )<br><br>    style_loss = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> style_weights:<br>        target_feature = target_features[layer]<br>        target_gram = gram_matrix(tensor=target_feature)<br>        _, d, h, w = target_feature.shape<br>        style_gram = style_grams[layer]<br>        <span class="hljs-comment"># 计算风格损失，遍历每一层的权重 style_weights，计算目标图像在该层的 Gram 矩阵与风格图像在该层的 Gram 矩阵之间的均方误差，并加权求和</span><br>        layer_style_loss = style_weights[layer] * torch.mean(<br>            (target_gram - style_gram) ** <span class="hljs-number">2</span><br>        )<br>        style_loss += layer_style_loss / (d * h * w)<br><br>    <span class="hljs-comment"># 计算总损失，包括内容损失和风格损失，其中通过 content_weight 和 style_weight 分别控制两者的权重</span><br>    total_loss = content_weight * content_loss + style_weight * style_loss<br><br>    optimizer.zero_grad()  <span class="hljs-comment"># 使用优化器进行梯度清零</span><br>    total_loss.backward()  <span class="hljs-comment"># 反向传播总损失</span><br>    optimizer.step()  <span class="hljs-comment"># 更新参数</span><br><br>    <span class="hljs-comment"># 展示训练过程</span><br>    <span class="hljs-keyword">if</span> i % show_every == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Total Loss:&quot;</span>, total_loss.item())<br>        plt.imshow(im_convert(tensor=target))<br>        plt.show()<br></code></pre></td></tr></table></figure><p>使用内容图像和风格图像来生成一个新的目标图像，使其同时保留内容和风格特征。具体步骤如下：</p><ol type="1"><li><p>设置训练过程中的输出频率和总迭代次数。</p></li><li><p>定义优化器为 Adam，并传入目标图像 target作为要优化的参数。</p></li><li><p>在每次迭代中，计算目标图像在不同层的特征表示，然后分别计算内容损失和风格损失。</p></li><li><p>内容损失计算目标图像与内容图像在特定层特征之间的均方误差。</p></li><li><p>风格损失通过计算目标图像在每层的Gram矩阵与风格图像在对应层的 Gram矩阵的均方误差，并加权求和得到。</p></li><li><p>总损失由内容损失和风格损失加权求和得到。</p></li><li><p>使用优化器进行梯度清零，反向传播总损失，更新参数。</p></li><li><p>每隔一定迭代次数展示训练过程中的目标图像及当前总损失。</p></li><li><p>这个训练过程将逐步调整目标图像，使其在内容和风格上与内容图像和风格图像相似。通过迭代训练，最终可以得到一个同时保留了内容和风格特征的合成图像。</p></li></ol><p>如下图所示，我们可以看到，合成图像保留了内容图像的风景和物体，并同时迁移了风格图像的色彩。例如，合成图像具有与风格图像中一样的色彩块，其中一些甚至具有画笔笔触的细微纹理。</p><figure><img src="style_transfer.png" alt="风格图像生成过程" /><figcaption aria-hidden="true">风格图像生成过程</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>卷积神经网络</tag>
      
      <tag>CNN</tag>
      
      <tag>色彩风格迁移</tag>
      
      <tag>预训练模型</tag>
      
      <tag>VGG 19</tag>
      
      <tag>python</tag>
      
      <tag>pytorch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>下降阶乘幂</title>
    <link href="/2024/05/04/descendingStepExponentiation/"/>
    <url>/2024/05/04/descendingStepExponentiation/</url>
    
    <content type="html"><![CDATA[<html><script>MathJax = {  loader: {    load: ['[tex]/physics']  },  tex: {    packages: {'[+]': ['physics']}  }};</script><script id="MathJax-script" async  src="https://cdnjs.loli.net/ajax/libs/mathjax/3.0.1/es5/tex-mml-chtml.js"></script></html><h1 id="下降阶乘幂">下降阶乘幂</h1><h2 id="相关定义与定理">相关定义与定理</h2><ol type="1"><li><span class="math inline">\(x^{\underline{m}}=x(x-1)\cdots(x-m+1)~~(m\in\mathbb{N}_+).\)</span></li><li><spanclass="math inline">\(x^{\overline{m}}=x(x+1)\cdots(x+m-1)~~(m\in\mathbb{N}_+).\)</span></li><li><spanclass="math inline">\(x^{\underline{0}}=x^{\overline{0}}=1.\)</span></li><li><spanclass="math inline">\(n!=n^{\underline{n}}=1^{\overline{n}}.\)</span></li><li><span class="math inline">\(\varDelta\qty(x^{\underline{m}})=mx^{\underline{m-1}}.\)</span></li><li><span class="math inline">\(\displaystyle g(x)=\varDelta f(x)\iff\sum g(x)\delta x=f(x)+C.\)</span></li><li><span class="math inline">\(\displaystyle \sum\nolimits_{a}^{b}g(x)\delta x=\eval{f(x)}_{a}^{b}=f(b)-f(a).\)</span></li><li><span class="math inline">\(\displaystyle\sum\nolimits_{a}^{b}g(x)\delta x=\sum_{k=a}^{b-1}g(k)=\sum_{a\leqslantk&lt;b}g(k)~~(b\geqslant a).\)</span></li><li><span class="math inline">\(\displaystyle\sum\nolimits_{a}^{b}g(x)\delta x+\sum\nolimits_b^c g(x)\deltax=\sum\nolimits_a^cg(x)\delta x.\)</span></li><li><span class="math inline">\(\displaystyle \sum_{0\leqslantk&lt;n}k^{\underline{m}}=\eval{\dfrac{k^{\underline{m+1}}}{m+1}}_{0}^{n}=\dfrac{n^{\underline{m+1}}}{m+1}~~(m,n\in\mathbb{N}_+).\)</span></li><li><spanclass="math inline">\(x^{\underline{-m}}=\dfrac{1}{(x+1)(x+2)\cdots(x+m)}~~(m&gt;0).\)</span></li><li><spanclass="math inline">\(x^{\underline{m+n}}=x^{\underline{m}}(x-m)^{\underline{n}}~~(m,n\in\mathbb{Z}).\)</span></li><li><span class="math inline">\(\displaystyle\sum\nolimits_a^bx^{\underline{m}}\delta x=\begin{cases}\eval{\dfrac{x^{\underline{m+1}}}{m+1}}_{a}^{b}, &amp; m\neq -1 \\\eval{H_x}_{a}^{b},                              &amp; m=-1\end{cases}\)</span>， 其中 <span class="math inline">\(\displaystyleH_x=\sum_{k=1}^{x}\dfrac{1}{k}\)</span> 称为调和级数.</li><li><span class="math inline">\(\mathrm{E}f(x)=f(x+1).\)</span></li><li><span class="math inline">\(\displaystyle\sum u\varDeltav=uv-\sum\mathrm{E}v\varDelta u.\)</span></li></ol><h2 id="例题">例题</h2><p>判断级数 <spanclass="math inline">\(\displaystyle\sum_{n=1}^{\infty}\dfrac{1+\dfrac{1}{2}+\cdots+\dfrac{1}{n}}{(n+1)(n+2)}\)</span>的敛散性，若收敛，则求其和.</p><h3 id="解答">解答</h3><p>令 <span class="math inline">\(\displaystyleH_n=\sum_{k=1}^{n}\dfrac{1}{k}~,S_n=\sum_{k=1}^{n}\dfrac{H_k}{(k+1)(k+2)}=\sum_{\substack{1\leqslantk&lt;n+1\\k\in\mathbb{N}_+}}\dfrac{H_k}{(k+1)(k+2)}=\sum\nolimits_1^{n+1}\dfrac{H_x}{(x+1)(x+2)}\deltax\)</span>， 那么记 <span class="math display">\[u(x)=H_x~,\varDeltav(x)=\dfrac{1}{(x+1)(x+2)}=-\dfrac{1}{x+2}-\qty(-\dfrac{1}{x+1})\]</span>因此 <span class="math display">\[\varDeltau(x)=x^{\underline{-1}},~v(x)=-\dfrac{1}{x+1}=-x^{\underline{-1}},~\mathrm{E}v(x)=-(x+1)^{\underline{-1}}\]</span>于是 <span class="math display">\[\begin{align*}    S_n &amp; =\sum\nolimits_1^{n+1}\dfrac{H_x}{(x+1)(x+2)}\deltax=\eval{-x^{\underline{-1}}H_x}_{1}^{n+1}+\sum\nolimits_{1}^{n+1}(x+1)^{\underline{-1}}x^{\underline{-1}}\deltax          \\        &amp;=-(n+1)^{\underline{-1}}H_{n+1}+1^{\underline{-1}}H_1+\sum\nolimits_{1}^{n+1}x^{\underline{-2}}\deltax=\dfrac{1}{2}-\dfrac{H_{n+1}}{n+2} -\eval{x^{\underline{-1}}}_{1}^{n+1}\\        &amp;=1-\dfrac{1}{n+2}-\dfrac{H_{n+1}}{n+2}=1-\dfrac{1}{n+1}-\dfrac{H_n}{n+2}\end{align*}\]</span> 又因为 <spanclass="math display">\[\lim_{n\to\infty}\dfrac{H_n}{n+2}=\lim_{n\to\infty}\dfrac{\lnn+\gamma+\alpha(n)}{n+2}=\lim_{n\to\infty}\dfrac{\lnn}{n+2}=0~~(\alpha(n)\to0)\]</span> 所以 <spanclass="math inline">\(\displaystyle\lim_{n\to\infty}S_n=1\)</span>，因此级数收敛，且其和为1.</p>]]></content>
    
    
    <categories>
      
      <category>数学笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>高等数学</tag>
      
      <tag>数学技巧</tag>
      
      <tag>考研数学</tag>
      
      <tag>无穷级数</tag>
      
      <tag>幂级数</tag>
      
      <tag>有限微积分</tag>
      
      <tag>下降阶乘幂</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>二次型化为标准形</title>
    <link href="/2024/05/04/theQuadraticTypeIsConvertedIntoAStandardType/"/>
    <url>/2024/05/04/theQuadraticTypeIsConvertedIntoAStandardType/</url>
    
    <content type="html"><![CDATA[<html><script>MathJax = {  loader: {    load: ['[tex]/physics']  },  tex: {    packages: {'[+]': ['physics']}  }};</script><script id="MathJax-script" async  src="https://cdnjs.loli.net/ajax/libs/mathjax/3.0.1/es5/tex-mml-chtml.js"></script></html><h1 id="二次型化为标准形">二次型化为标准形</h1><h2 id="方法论">方法论</h2><p>运用偏导函数的思想将二次型化为标准形有以下两种情况:</p><ol type="1"><li><p>如果 <span class="math inline">\(f(x_1,x_2,\cdots,x_n)\)</span>中含有某变量的平方项，即 <span class="math inline">\(a_{i i}~ (i=1,\cdots, n)\)</span> 中至少有一个不为零， 不妨设 <spanclass="math inline">\(a_{11} \neq 0\)</span>，记 <spanclass="math inline">\(\displaystyle f_{1}=\frac{1}{2} \frac{\partialf}{\partial x_{1}}\)</span>， 令 <spanclass="math display">\[f(x_1,x_2,\cdots,x_n)=\frac{1}{a_{11}}f_1^2+g\]</span>求得 <span class="math inline">\(g\)</span>，此时 <spanclass="math inline">\(g\)</span> 中已不含 <spanclass="math inline">\(x_{1}\)</span>，再记 <spanclass="math inline">\(\displaystyle g_{1}=\frac{1}{2} \frac{\partialg}{\partial x_{2}}\)</span>，并令 <spanclass="math display">\[f(x_1,x_2,\cdots,x_n)=\frac{1}{a_{11}}f_1^2+\frac{1}{a_{22}}g_1^2+h\]</span>此时 <span class="math inline">\(h\)</span> 中已不含 <spanclass="math inline">\(x_1\)</span> 与 <spanclass="math inline">\(x_2\)</span>，按这种方法继续运算，可将二次型化为标准形;</p></li><li><p>如果 <span class="math inline">\(f(x_1,x_2,\cdots,x_n)\)</span>中不含有任一变量的平方项，即 <span class="math inline">\(a_{ii}=0~(i=1,\cdots,n)\)</span>，但至少有一个 <spanclass="math inline">\(a_{1j}\neq 0~ (j&gt;1)\)</span> 不为零 (<spanclass="math inline">\(a_{ij}\)</span> 是 <spanclass="math inline">\(x_{ij}\)</span> 项的系数)， 不妨设 <spanclass="math inline">\(a_{12}\neq 0\)</span>，记 <spanclass="math inline">\(f_1=\dfrac{1}{2}\displaystyle\pdv{f}{x_1},f_2=\dfrac{1}{2}\displaystyle\pdv{f}{x_2}\)</span>，令<spanclass="math display">\[f(x_1,x_2,\cdots,x_n)=\dfrac{1}{a_{12}}\qty[(f_1+f_2)^2-(f_1-f_2)^2]+\varphi\]</span>求得 <span class="math inline">\(\varphi\)</span>，此时 <spanclass="math inline">\(\varphi\)</span> 中已不含 <spanclass="math inline">\(x_1\)</span> 与 <spanclass="math inline">\(x_2\)</span>，观察 <spanclass="math inline">\(\varphi\)</span> 的结构，如果 <spanclass="math inline">\(\varphi\)</span>中含有变量的平方项，则按情况一中的方法进行，否则按情况二中的方法进行，直至二次型化为标准形.</p></li></ol><h2 id="例题-1">例题 1</h2><p>将二次型 <spanclass="math inline">\(f(x_1,x_2,x_3)=x_1^2+2x_2^2-4x_3^2+2x_1x_2-2x_2x_3\)</span>化为标准形.</p><h3 id="解答">解答</h3><p>记 <spanclass="math inline">\(f_1=\dfrac{1}{2}\displaystyle\pdv{f}{x_1}=x_1+x_2\)</span>，令<spanclass="math display">\[f=\dfrac{1}{a_{11}}f_1^2+g=(x_1+x_2)^2+g\]</span>求得 <span class="math inline">\(g=x_2^2-4x_3^2-2x_2x_3\)</span>，记<spanclass="math inline">\(g_1=\dfrac{1}{2}\displaystyle\pdv{g}{x_2}=x_2-x_3\)</span>，令<span class="math display">\[g=\dfrac{1}{a_{22}}g_1^2+h\]</span> 求得<span class="math inline">\(h=-5x_3^2\)</span>，那么 <spanclass="math display">\[f(x_1,x_2,x_3)=(x_1+x_2)^2+(x_2-x_3)^2-5x_3^2\]</span>作可逆线性变换 <span class="math display">\[\left\{\begin{matrix}            y_1 &amp; = &amp; x_1 &amp; + &amp; x_2           \\            y_2 &amp; = &amp;     &amp;   &amp; x_2 &amp; - &amp; x_3 \\            y_3 &amp; = &amp;     &amp;   &amp;     &amp;   &amp; x_3        \end{matrix}\right.\]</span> 则有 <spanclass="math inline">\(f(y_1,y_2,y_3)=y_1^2+y_2^2-5y_3^2.\)</span></p><h2 id="例题-2">例题 2</h2><p>将二次型 <spanclass="math inline">\(f(x_1,x_2,x_3)=-4x_1x_2+2x_1x_3+2x_2x_3\)</span>化为标准形.</p><h3 id="解答-1">解答</h3><p>二次型中不含有任一变量的平方项，记 <spanclass="math inline">\(f_1=\dfrac{1}{2}\displaystyle\pdv{f}{x_1},~f_2=\dfrac{1}{2}\displaystyle\pdv{f}{x_2}\)</span>，则有<spanclass="math display">\[f_1=\dfrac{1}{2}(-4x_2+2x_3)=-2x_2+x_3,~f_2=\dfrac{1}{2}(-4x_1+2x_3)=-2x_1+x_3\]</span>令 <span class="math display">\[\begin{align*}    f &amp;=\dfrac{1}{a_{12}}\qty[(f_1+f_2)^2-(f_1-f_2)^2]+\varphi=-\dfrac{1}{4}\qty[(-2x_1-2x_2+2x_3)^2-(2x_1-2x_2)^2]+\varphi\\      &amp;=(x_1-x_2)^2-(x_1+x_2-x_3)^2+\varphi=(2x_1-x_3)(-2x_2+x_3)+\varphi=-4x_1x_2+2x_1x_3+2x_2x_3-x_3^2+\varphi\end{align*}\]</span> 即 <spanclass="math inline">\(\varphi=x_3^2\)</span>，所以 <spanclass="math display">\[f(x_1,x_2,x_3)=-(x_1+x_2-x_3)^2+(x_1-x_2)^2+x_3^2\]</span>作可逆线性变换 <span class="math inline">\(\left\{\begin{matrix}        y_1 &amp; = &amp; x_1 &amp; + &amp; x_2 &amp; - &amp; x_3 \\        y_2 &amp; = &amp; x_1 &amp; - &amp; x_2 &amp;         \\        y_3 &amp; = &amp;     &amp;   &amp;     &amp;   &amp; x_3    \end{matrix}\right.\)</span>，则有 <spanclass="math inline">\(f(y_1,y_2,y_3)=-y_1^2+y_2^2+y_3^2.\)</span></p><h2 id="例题-3">例题 3</h2><p>二次型 <spanclass="math display">\[f(x_1,x_2,x_3)=(x_1+x_2)^2+(x_1+x_3)^2-4(x_2-x_3)^2\]</span>的标准形为</p><p>A. <span class="math inline">\(y_1^2+y_2^2~~~~~~\)</span> B. <spanclass="math inline">\(y_1^2-y_2^2~~~~~~\)</span> C. <spanclass="math inline">\(y_1^2+y_2^2-4y_3^2~~~~~~\)</span> D. <spanclass="math inline">\(y_1^2+y_2^2-y_3^2\)</span></p><h3 id="解答-2">解答</h3><p>将 <span class="math inline">\(f\)</span> 完全展开，得 <spanclass="math display">\[f=2x_1^2-3x_2^2-3x_3^2+2x_1x_2+2x_1x_3+8x_2x_3\]</span>那么 <spanclass="math display">\[f_1=\dfrac{1}{2}\pdv{f}{x_1}=\dfrac{1}{2}(4x_1+2x_2+2x_3)=2x_1+x_2+x_3\]</span>则 <spanclass="math display">\[f=\dfrac{1}{a_{11}}f_1^2+g=2x_1^2+\dfrac{1}{2}x_2^2+\dfrac{1}{2}x_3^2+2x_1x_2+2x_1x_3+x_2x_3+g\]</span>对比可得 <spanclass="math inline">\(g=-\dfrac{7}{2}x_2^2-\dfrac{7}{2}x_3^2+7x_2x_3\)</span>，再令 <spanclass="math display">\[g_1=\dfrac{1}{2}\pdv{g}{x_2}=\dfrac{1}{2}(-7x_2+7x_3)=-\dfrac{7}{2}x_2+\dfrac{7}{2}x_3\]</span>又 <spanclass="math inline">\(g=\dfrac{1}{a_{22}}g_1^2+h\)</span>，可解出 <spanclass="math inline">\(h=0\)</span>，因此可排除 C，D 选项， <spanclass="math display">\[f=\dfrac{1}{\sqrt{2}^2}(2x_1+x_2+x_3)^2-\sqrt{\dfrac{7}{2}}^2(x_2-x_3)^2\]</span>作可逆线性变换 <span class="math inline">\(\begin{cases}            y_1=\dfrac{1}{\sqrt{2}} (2x_1+x_2+x_3) \\[6pt]            y_2=\sqrt{\dfrac{7}{2} } (x_2-x_3)     \\[6pt]            y_3=x_3\end{cases}\)</span>，因此 <spanclass="math inline">\(f(y_1,y_2,y_3)=y_1^2-y_2^2\)</span> 选 B.</p>]]></content>
    
    
    <categories>
      
      <category>数学笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数学技巧</tag>
      
      <tag>考研数学</tag>
      
      <tag>线性代数</tag>
      
      <tag>二次型</tag>
      
      <tag>标准形</tag>
      
      <tag>偏导函数</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>极大似然估计</title>
    <link href="/2024/05/03/greatLikelihoodEstimation/"/>
    <url>/2024/05/03/greatLikelihoodEstimation/</url>
    
    <content type="html"><![CDATA[<html><script>MathJax = {  loader: {    load: ['[tex]/physics']  },  tex: {    packages: {'[+]': ['physics']}  }};</script><script id="MathJax-script" async  src="https://cdnjs.loli.net/ajax/libs/mathjax/3.0.1/es5/tex-mml-chtml.js"></script></html><h1 id="极大似然估计">极大似然估计</h1><p>极大似然估计法是参数估计使用的最广泛的方法，最早由德国数学家 Gauss 在1821 年提出， 但是此法一般归功于英国统计学家 Fisher，因为 Fisher 于 1922年再次提出了这个思想，并且证明了这种方法的一些性质，从而使得极大似然法得到更普遍的应用.</p><h2 id="例题-1">例题 1</h2><p>设总体概率函数如下，<spanclass="math inline">\(x_1,x_2,\cdots,x_n\)</span>是样本，试求未知参数的极大似然估计: <spanclass="math display">\[\displaystylep(x;\theta)=\sqrt{\theta}x^{\sqrt{\theta}-1},0&lt;x&lt;1,\theta&gt;0;\]</span></p><h3 id="解答">解答</h3><p>似然函数 <span class="math inline">\(\displaystyle L(\theta)=\left(\sqrt{\theta }\right) ^{n}\left( \prod ^{n}_{i=1}x_{i}\right)^{\sqrt{\theta }-1}\)</span>，取对数得 <span class="math display">\[\lnL\left( \theta \right) =\dfrac{n}{2}\ln \theta +\left( \sqrt{\theta}-1\right) \sum ^{n}_{i=1}\ln x_{i}\]</span> 将 <spanclass="math inline">\(\ln L(\theta)\)</span> 关于 <spanclass="math inline">\(\theta\)</span> 求导，并令其值为 <spanclass="math inline">\(0\)</span> 即得到似然函数 <spanclass="math display">\[\dfrac{\partial \ln L\left( \theta \right)}{\partial \theta }=\dfrac{n}{2\theta }+\dfrac{1}{2\sqrt{\theta }}\sum^{n}_{i=1}x_{i}=0\]</span> 解得 <spanclass="math inline">\(\displaystyle\widehat{\theta }=\left(\dfrac{1}{n}\sum ^{n}_{i=1}\ln x_{i}\right) ^{-2}\)</span>，并且 <spanclass="math display">\[ \dfrac{\partial ^{2}\ln L\left( \theta \right)}{\partial \theta ^{2}}\bigg | _{\theta=\widehat{\theta }}= \left(-\dfrac{n}{2\theta ^{2}}-\dfrac{1}{4\theta ^{3/2}}\sum ^{n}_{i=1}\lnx_{i}\right) \bigg | _{\theta=\widehat{\theta}}=-\dfrac{3}{4n^{3}}\left( \sum ^{n}_{i=1}\ln x_{i}\right)^{4}&lt;0\]</span> 所以 <spanclass="math inline">\(\widehat{\theta}\)</span> 是 <spanclass="math inline">\(\theta\)</span> 的极大似然估计.</p><h2 id="例题-2">例题 2</h2><p>设总体概率函数如下，<spanclass="math inline">\(x_1,x_2,\cdots,x_n\)</span>是样本，试求未知参数的极大似然估计: <spanclass="math display">\[\displaystyle p(x;\theta)=\theta c^\thetax^{-(\theta+1)},x&gt;c&gt;0,\theta&gt;1.\]</span></p><h3 id="解答-1">解答</h3><p>似然函数 <span class="math inline">\(\displaystyle L(\theta)=\theta^{n}c^{n\theta }\left( \prod ^{n}_{i=1}x_{i}\right) ^{-\left( \theta+1\right) }\)</span>，取对数得 <span class="math display">\[\ln L\left(\theta \right) =n\ln \theta +n\theta \ln c-\left( \theta +1\right) \sum^{n}_{i=1}\ln x_{i}\]</span> 将 <span class="math inline">\(\lnL(\theta)\)</span> 关于 <span class="math inline">\(\theta\)</span>求导，并令其值为 <span class="math inline">\(0\)</span> 即得到似然函数<span class="math display">\[\dfrac{\partial \ln L\left( \theta \right)}{\partial \theta }=\dfrac{n}{\theta }+n\ln c-\sum ^{n}_{i=1}\lnx_{i}=0\]</span> 解得 <span class="math inline">\(\displaystyle\widehat{\theta }=\left[ \dfrac{1}{n}\sum ^{n}_{i=1}\left( \ln x_{i}-\lnc\right) \right] ^{-1}\)</span>， 并且 <spanclass="math inline">\(\displaystyle \dfrac{\partial ^{2}\ln L\left(\theta \right) }{\partial \theta ^{2}}=\dfrac{-n}{\theta ^{2}}&lt;0\)</span>，所以 <spanclass="math inline">\(\widehat{\theta}\)</span> 是 <spanclass="math inline">\(\theta\)</span> 的极大似然估计.</p><h2 id="例题-3">例题 3</h2><p>设某种元件的使用寿命 <span class="math inline">\(T\)</span>的分布函数为 <span class="math display">\[F(t)=\begin{cases}            1-\mathrm{e}^{-\qty(\frac{t}{\theta})^m} &amp; ,t\geqslant 0\\            0                                        &amp; ,\text{其他}        \end{cases}\]</span> 其中 <spanclass="math inline">\(m,~\theta\)</span> 为参数且大于 0，任取 <spanclass="math inline">\(n\)</span>个这种元件做寿命试验，测得它们的寿命分别为 <spanclass="math inline">\(t_1,t_2,\cdots,t_n\)</span>，若 <spanclass="math inline">\(m\)</span> 已知，求 <spanclass="math inline">\(\theta\)</span> 的极大似然估计值 <spanclass="math inline">\(\hat\theta.\)</span></p><h3 id="解答-2">解答</h3><p>由 <span class="math inline">\(f(t)=F&#39;(t)\)</span>可得概率密度函数 <span class="math display">\[f(t)=\begin{cases}        \dfrac{mt^{m-1}}{\theta^m}\mathrm{e}^{-\qty(\frac{t}{\theta})^m}&amp; ,t\geqslant 0 \\        0                                                                &amp;,t&lt;0    \end{cases}\]</span> 对数似然函数为 <spanclass="math display">\[\begin{align*}    \ln\qty[L(\theta)] &amp;=\ln\qty[\prod_{i=1}^{n}f(t_i;\theta)]=\ln\qty[\prod_{i=1}^{n}\dfrac{mt_i^{m-1}}{\theta^m}\mathrm{e}^{-\qty(\frac{t_i}{\theta})^m}]=\ln\qty[\dfrac{m^n(t_1t_2\cdotst_n)^{m-1}}{\theta^{mn}}\cdot\mathrm{e}^{-\frac{1}{\theta^m}\sum\limits_{i=1}^{n}t_i^m}]\\                       &amp; =n\lnm+(m-1)\ln\prod_{i=1}^{n}t_i-mn\ln\theta-\dfrac{1}{\theta^m}\sum_{i=1}^{n}t_i^m\end{align*}\]</span> 求导得 <spanclass="math inline">\(\displaystyle\dv{\ln\qty[L(\theta)]}{\theta}=-\dfrac{mn}{\theta}+m\dfrac{1}{\theta^{m+1}}\sum_{i=1}^{n}t_i^m=0\)</span>，解得<spanclass="math inline">\(\displaystyle\dfrac{1}{\theta^m}\sum_{i=1}^{n}t_i^m=n\)</span>，那么 <span class="math inline">\(\theta\)</span> 的极大似然估计值为<spanclass="math inline">\(\hat\theta=\sqrt[m]{\dfrac{1}{n}\displaystyle\sum_{i=1}^{n}t_i^m}.\)</span></p>]]></content>
    
    
    <categories>
      
      <category>数学笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>考研数学</tag>
      
      <tag>概率论与数理统计</tag>
      
      <tag>参数的点估计</tag>
      
      <tag>极大似然估计</tag>
      
      <tag>似然函数</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hesse 矩阵与极值定理</title>
    <link href="/2024/05/03/hesseMatricesAndTheExtremeValueTheorem/"/>
    <url>/2024/05/03/hesseMatricesAndTheExtremeValueTheorem/</url>
    
    <content type="html"><![CDATA[<html><script>MathJax = {  loader: {    load: ['[tex]/physics']  },  tex: {    packages: {'[+]': ['physics']}  }};</script><script id="MathJax-script" async  src="https://cdnjs.loli.net/ajax/libs/mathjax/3.0.1/es5/tex-mml-chtml.js"></script></html><h1 id="hesse-矩阵与极值定理">Hesse 矩阵与极值定理</h1><h2 id="定理">定理</h2><p>设 <span class="math inline">\(P_{0}\)</span> 为稳定点，若在 <spanclass="math inline">\(P_{0}\)</span> 处 Hesse 矩阵 <spanclass="math display">\[\vb*{H}(P_0)=\mqty(f_{x_{1} x_{1}}^{\prime\prime} &amp; f_{x_{1} x_{2}}^{\prime \prime} &amp; \cdots &amp;f_{x_{1} x_{n}}^{\prime \prime} \\f_{x_{2} x_{1}}^{\prime \prime} &amp;f_{x_{2} x_{2}}^{\prime \prime} &amp; \cdots &amp; f_{x_{2}x_{n}}^{\prime \prime} \\\vdots &amp; \vdots &amp; &amp; \vdots \\f_{x_{n} x_{1}}^{\prime \prime} &amp; f_{x_{n} x_{2}}^{\prime \prime}&amp; \cdots &amp; f_{x_{n} x_{n}}^{\prime \prime})\]</span>为正定的，则 <span class="math inline">\(f\)</span> 在 <spanclass="math inline">\(P_{0}\)</span> 处取极小值; 若 <spanclass="math inline">\(\boldsymbol{H}\left(P_{0}\right)\)</span>为负定的，则 <span class="math inline">\(f\)</span> 在 <spanclass="math inline">\(P_{0}\)</span> 处取极大值; 若 <spanclass="math inline">\(\boldsymbol{H}\left(P_{0}\right)\)</span>为不定的, 则 <span class="math inline">\(f\)</span> 在 <spanclass="math inline">\(P_{0}\)</span> 处无极值.</p><h2 id="例题-1">例题 1</h2><p>求函数 <span class="math inline">\(f(x,y)=x^4+y^4-(x+y)^2\)</span>的极值.</p><h3 id="解答">解答</h3><p>令 <span class="math inline">\(\begin{cases}    f_x&#39;(x,y)=4x^3-2(x+y)=0\\    f_y&#39;(x,y)=4y^3-2(x+y)=0\end{cases}\)</span> 解得驻点 <spanclass="math inline">\(P_1(0,0),~P_2(1,1),~P_3(-1,-1)\)</span>，又 <spanclass="math display">\[\displaystyle\pdv[2]{f}{x}=12x^2-2,~\pdv[2]{f}{y}=12y^2-2,~\pdv{f}{x}{y}=-2,~\pdv{f}{y}{x}=-2\]</span>由 Hesse 矩阵 <spanclass="math inline">\(\vb*{H}(P_1)=\mqty(-2&amp;-2\\-2&amp;-2),~\vb*{H}(P_2)=\mqty(10&amp;-2\\-2&amp;10),~\vb*{H}(P_3)=\mqty(10&amp;-2\\-2&amp;10)\)</span>且 <span class="math inline">\(\vb*{H}(P_1)\)</span> 不定，故 <spanclass="math inline">\((0,0)\)</span> 不是极值点; <spanclass="math inline">\(\vb*{H}(P_2)\)</span> 正定，故 <spanclass="math inline">\((1,1)\)</span> 为极小值点; <spanclass="math inline">\(\vb*{H}(P_3)\)</span> 正定，故 <spanclass="math inline">\((-1,-1)\)</span> 为极小值点， 综上，<spanclass="math inline">\(f\)</span> 的极小值为 <spanclass="math inline">\(f(1,1)=f(-1,-1)=-2.\)</span></p><h2 id="例题-2">例题 2</h2><p>设 <span class="math inline">\(z=z(x,y)\)</span> 是由 <spanclass="math inline">\(x^2-6xy+10y^2-2yz-z^2+18=0\)</span> 确定的函数，求<span class="math inline">\(z=z(x,y)\)</span> 的极值点与极值.</p><h3 id="解答-1">解答</h3><p>在 <span class="math inline">\(x^2-6xy+10y^2-2yz-z^2+18=0\)</span>两边对 <span class="math inline">\(x,~y\)</span> 求偏导，得 <spanclass="math inline">\(\begin{cases}    \displaystyle 2x-6y-2y\pdv{z}{x}-2z\pdv{z}{x}=0\\    \displaystyle -6x+20y-2z-2y\pdv{z}{y}-2z\pdv{z}{y}=0\end{cases}\)</span> 令 <span class="math inline">\(\begin{cases}    z&#39;_x=0\\ z&#39;_y=0\end{cases}\)</span>，得 <span class="math inline">\(\begin{cases}    x=3y\\ z=y\end{cases}\)</span> 代入 <spanclass="math inline">\(x^2-6xy+10y^2-2yz-z^2+18=0\)</span> 得 <spanclass="math inline">\(\begin{cases}    x=9\\ y=3 \\ z=3\end{cases}\text{或 } \begin{cases}    x=-9\\ y=-3 \\ z=-3\end{cases}\)</span> 并且 <span class="math display">\[\begin{align*}    0=&amp;2-2y\pdv[2]{z}{x}-2\qty(\pdv{z}{x})^2-2z\pdv[2]{z}{x} \\    0=&amp;-6-2\pdv{z}{x}-2y\pdv{z}{x}{y}-2\pdv{z}{y}\pdv{z}{x}-2z\pdv{z}{x}{y}\\    0=&amp;20-2\pdv{z}{y}-2\pdv{z}{y}-2y\pdv[2]{z}{y}-2\qty(\pdv{z}{y})^2-2z\pdv[2]{z}{y}\end{align*}\]</span> 于是 <spanclass="math inline">\(\vb*{H}(P_1)=\eval{\mqty(z&#39;&#39;_{xx}&amp;z&#39;&#39;_{xy}\\z&#39;&#39;_{yx}&amp;z&#39;&#39;_{yy})}_{(9,3,3)}=\mqty(\dfrac{1}{6}&amp;-\dfrac{1}{2}\\[6pt]-\dfrac{1}{2}&amp;\dfrac{5}{3})\)</span>正定，故点 <span class="math inline">\((9,3)\)</span> 是 <spanclass="math inline">\(z(x,y)\)</span> 的极小值点，极小值为 <spanclass="math inline">\(z(9,3)=3\)</span>， 同理可得 <spanclass="math inline">\(\vb*{H}(P_2)=\mqty(-\dfrac{1}{6}&amp;\dfrac{1}{2}\\[6pt]\dfrac{1}{2}&amp;-\dfrac{5}{3})\)</span>负定，从而点 <span class="math inline">\((-9,-3)\)</span> 是 <spanclass="math inline">\(z(x,y)\)</span> 的极大值点，极大值为 <spanclass="math inline">\(z(-9,-3)=-3.\)</span></p><h2 id="例题-3">例题 3</h2><p>求函数 <spanclass="math inline">\(f(x,y)=x\mathrm{e}^{-\frac{x^2+y^2}{2}}\)</span>的极值.</p><h3 id="解答法一">解答：法一</h3><p>令 <span class="math inline">\(\begin{cases}    f_x&#39;(x,y)=\mathrm{e}^{-\frac{x^2+y^2}{2}}-x^2\mathrm{e}^{-\frac{x^2+y^2}{2}}=0\\[6pt]    f_y&#39;(x,y)=-xy \mathrm{e}^{-\frac{x^2+y^2}{2}}=0\end{cases}\)</span> 解得驻点 <spanclass="math inline">\(P_1(1,0),~P_2(-1,0)\)</span>，且 <spanclass="math display">\[\pdv[2]{f}{x}=-3x\mathrm{e}^{-\frac{x^2+y^2}{2}}+x^3\mathrm{e}^{-\frac{x^2+y^2}{2}},~\pdv[2]{f}{y}=-x\mathrm{e}^{-\frac{x^2+y^2}{2}}+xy^2\mathrm{e}^{-\frac{x^2+y^2}{2}},~\pdv{f}{x}{y}=-y\mathrm{e}^{-\frac{x^2+y^2}{2}}+x^2y\mathrm{e}^{-\frac{x^2+y^2}{2}}=\pdv{f}{y}{x}\]</span>由 Hesse 矩阵 <spanclass="math inline">\(\vb*{H}(P_1)=\mqty(-2\mathrm{e}^{-\frac{1}{2}}&amp;0\\0&amp;-\mathrm{e}^{-\frac{1}{2}}),~\vb*{H}(P_2)=\mqty(2\mathrm{e}^{-\frac{1}{2}}&amp;0\\0&amp;\mathrm{e}^{-\frac{1}{2}})\)</span>，<spanclass="math inline">\(\vb*{H}(P_1)\)</span> 负定，故 <spanclass="math inline">\((1,0)\)</span> 为极大值点; <spanclass="math inline">\(\vb*{H}(P_2)\)</span> 正定，故 <spanclass="math inline">\((-1,0)\)</span> 为极大值点， 因此 <spanclass="math inline">\(f\)</span> 的极大值为 <spanclass="math inline">\(f(1,0)=\mathrm{e}^{-\frac{1}{2}}\)</span>;极小值为 <spanclass="math inline">\(f(-1,0)=-\mathrm{e}^{-\frac{1}{2}}\)</span>.</p><h3 id="解答法二">解答：法二</h3><p>在驻点 <span class="math inline">\((1,0)\)</span> 处， <spanclass="math display">\[A=\left.\frac{\partial^{2} f}{\partialx^{2}}\right|_{(1,0)}=-2 \mathrm{e}^{-\frac{1}{2}},~B=\left.\frac{\partial^{2} f}{\partial x \partial y}\right|_{(1,0)}=0,~C=\left.\frac{\partial^{2} f}{\partialy^{2}}\right|_{(1,0)}=-\mathrm{e}^{-\frac{1}{2}}  \]</span> 由于 <spanclass="math inline">\(A C-B^{2}=2 \mathrm{e}^{-1}&gt;0\)</span>，且<span class="math inline">\(A&lt;0\)</span>，故 <spanclass="math inline">\((1,0)\)</span> 为极大值点，$f(1,0)=^{-} $为极大值; 在驻点 <span class="math inline">\((-1,0)\)</span> 处， <spanclass="math display">\[A=\left.\frac{\partial^{2} f}{\partialx^{2}}\right|_{(-1,0)}=2 \mathrm{e}^{-\frac{1}{2}},~B=\left.\frac{\partial^{2} f}{\partial x \partial y}\right|_{(-1,0)}=0,~C=\left.\frac{\partial^{2} f}{\partialy^{2}}\right|_{(-1,0)}=\mathrm{e}^{-\frac{1}{2}}\]</span> 由于 <spanclass="math inline">\(A C-B^{2}=2 \mathrm{e}^{-1}&gt;0,A&gt;0\)</span>，故 <span class="math inline">\((-1,0)\)</span>为极小值点， <spanclass="math inline">\(f(-1,0)=-\mathrm{e}^{-\frac{1}{2}}\)</span>为极小值.</p><h2 id="例题-4">例题 4</h2><p>已知函数 <span class="math inline">\(f(x,y)\)</span> 满足 <spanclass="math inline">\(f&#39;&#39;_{xy}(x,y)=2(y+1)\mathrm{e}^x,~f&#39;_x(x,0)=(x+1)\mathrm{e}^x,~f(0,y)=y^2+2y\)</span>，求<span class="math inline">\(f(x,y)\)</span> 的极值.</p><h3 id="解答-2">解答</h3><p>方程 <spanclass="math inline">\(f&#39;&#39;_{xy}(x,y)=2(y+1)\mathrm{e}^x\)</span>两边对 <span class="math inline">\(y\)</span> 求积分，得 <spanclass="math inline">\(f&#39;_x=\mathrm{e}^x(y+1)^2+\varphi(x)\)</span>，并令<span class="math inline">\(y=0\)</span>，与 <spanclass="math inline">\(f&#39;_x(x,0)=(x+1)\mathrm{e}^x\)</span> 对比得<span class="math inline">\(\varphi(x)=x\mathrm{e}^x\)</span>，那么<spanclass="math inline">\(f&#39;_x(x,y)=\mathrm{e}^x(y+1)^2+x\mathrm{e}^x\)</span>，两边再对<span class="math inline">\(x\)</span> 求积分，得 <spanclass="math display">\[f(x,y)=(y+1)^2\mathrm{e}^x+(x-1)\mathrm{e}^x+\psi(y)\]</span>又 <span class="math inline">\(f(0,y)=y^2+2y\)</span>，得 <spanclass="math inline">\(\psi(y)=0\)</span>，则 <spanclass="math inline">\(f(x,y)=(y+1)^2\mathrm{e}^x+(x-1)\mathrm{e}^x\)</span>，因此 <span class="math inline">\(\begin{cases}    f&#39;_x=(y+1)^2\mathrm{e}^x+x\mathrm{e}^x=0\\    f&#39;_y=2(y+1)\mathrm{e}^x=0\end{cases}\)</span> 得 <spanclass="math inline">\(x=0,~y=-1\)</span>，且 <spanclass="math inline">\(f&#39;&#39;_{xx}=(y+1)^2\mathrm{e}^x+(x+1)\mathrm{e}^x,~f&#39;&#39;_{xy}=2(y+1)\mathrm{e}^x,~f&#39;&#39;_{yy}=2\)</span>，则<spanclass="math inline">\(\vb*{H}(0,-1)=\eval{\mqty(z&#39;&#39;_{xx}&amp;z&#39;&#39;_{xy}\\z&#39;&#39;_{yx}&amp;z&#39;&#39;_{yy})}_{(0,-1)}\)</span>正定，于是 <span class="math inline">\(f(x,y)\)</span> 在 <spanclass="math inline">\((0,-1)\)</span> 处取得极小值，<spanclass="math inline">\(f(0,-1)=-1.\)</span></p><h2 id="例题-5">例题 5</h2><p>求函数 <spanclass="math inline">\(f(x,y)=\qty(y-x^2)\qty(y-x^3)\)</span> 的极值.</p><h3 id="解答-3">解答</h3><p>令 <span class="math inline">\(\begin{cases}        f_x&#39;(x,y)=5x^4-3x^2y-2xy=0 \\        f_y&#39;(x,y)=2y-x^3-x^2=0    \end{cases}\)</span> 解得驻点为 <spanclass="math inline">\(P_1(0,0),~P_2(1,1),~P_3\qty(\dfrac{2}{3},\dfrac{10}{27})\)</span>，且<spanclass="math display">\[\pdv[2]{f}{x}=20x^3-6xy-2y,~\pdv[2]{f}{y}=2,~\pdv{f}{x}{y}=-3x^2-2x=\pdv{f}{y}{x}\]</span>由 Hesse 矩阵得 <spanclass="math inline">\(\vb*{H}(P_1)=\mqty(0&amp;0\\0&amp;2)\)</span>为不定，故 <span class="math inline">\((0,0)\)</span> 非极值点; <spanclass="math inline">\(\vb*{H}(P_2)=\mqty(12&amp;-5\\-5&amp;2)\)</span>为不定，故 <span class="math inline">\((1,1)\)</span> 非极值点; <spanclass="math inline">\(\vb*{H}(P_3)=\mqty(\dfrac{100}{27}&amp;-\dfrac{8}{3}\\[6pt]-\dfrac{8}{3}&amp;2)\)</span>为正定，故 <spanclass="math inline">\(\qty(\dfrac{2}{3},\dfrac{10}{27})\)</span>为极小值点，且 函数的极小值为 <spanclass="math inline">\(f\qty(\dfrac{2}{3},\dfrac{10}{27})=-\dfrac{4}{27^2}.\)</span></p>]]></content>
    
    
    <categories>
      
      <category>数学笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>高等数学</tag>
      
      <tag>数学技巧</tag>
      
      <tag>考研数学</tag>
      
      <tag>一题多解</tag>
      
      <tag>Hesse 矩阵</tag>
      
      <tag>多元函数微分学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>积分等式命题的证明</title>
    <link href="/2024/05/03/proofOfThePropositionOfTheIntegralEquation/"/>
    <url>/2024/05/03/proofOfThePropositionOfTheIntegralEquation/</url>
    
    <content type="html"><![CDATA[<html><script>MathJax = {  loader: {    load: ['[tex]/physics']  },  tex: {    packages: {'[+]': ['physics']}  }};</script><script id="MathJax-script" async  src="https://cdnjs.loli.net/ajax/libs/mathjax/3.0.1/es5/tex-mml-chtml.js"></script></html><h1 id="积分等式命题的证明">积分等式命题的证明</h1><h2 id="例题-1">例题 1</h2><p>设 <span class="math inline">\(f(x)\inD(0,1),~f(0)=f(1)=-2,~\displaystyle\int_{0}^{1}f(x)\ddx=0\)</span>，证明: <spanclass="math inline">\(\exists\xi\in(0,1)\)</span>，使得 <spanclass="math inline">\(f&#39;(\xi)-f(\xi)=\xi.\)</span></p><h3 id="解答">解答</h3><p>令 <spanclass="math inline">\(F(x)=\mathrm{e}^{-x}(f(x)+x+1)\)</span>，有 <spanclass="math inline">\(F(0)=-1,~F(1)=0\)</span>，因为 <spanclass="math inline">\(\displaystyle\int_{0}^{1}f(x)\ddx=0\)</span>，由积分中值定理知，<spanclass="math inline">\(\exists\eta\in(0,1)\)</span>，使得 <spanclass="math display">\[\displaystyle\int_{0}^{1}f(x)\ddx=f(\eta)\int_{0}^{1}\dd x=f(\eta)=0\]</span> 而 <spanclass="math inline">\(F(\eta)=\mathrm{e}^{-\eta}(f(\eta)+\eta+1)&gt;0\)</span>，因此<span class="math inline">\(\exists\xi\in(0,1)\)</span>，使得 <spanclass="math inline">\(F(x)\leqslant F(\xi)\)</span>，即 <spanclass="math inline">\(F(x)\)</span> 的最大值一定在区间 <spanclass="math inline">\((0,1)\)</span> 内取到， 由 Fermat 引理知，<spanclass="math inline">\(F&#39;(\xi)=0\)</span>，即 <spanclass="math display">\[\eval{-\mathrm{e}^{-x}(f(x)+x+1)+\mathrm{e}^{-x}(f&#39;(x)+1)}_{x=\xi}=f&#39;(\xi)-f(\xi)=\xi.\]</span></p><h2 id="例题-2">例题 2</h2><p>设 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([2,4]\)</span> 上二阶连续可导，<spanclass="math inline">\(f(3)=0\)</span>，证明: <spanclass="math inline">\(\exists\xi\in(2,4)\)</span>，使得 <spanclass="math inline">\(\displaystylef&#39;&#39;(\xi)=3\int_{2}^{4}f(x)\dd x.\)</span></p><h3 id="解答-1">解答</h3><p>构造 <span class="math inline">\(\displaystyleF(x)=\int_{2}^{x}f(t)\dd t\)</span>，那么将 <spanclass="math inline">\(F(2),F(4)\)</span> 分别在 <spanclass="math inline">\(x=3\)</span> 处 Taylor 展开，有 <spanclass="math display">\[\begin{align*}F(2)=F(3)+F&#39;(3)(2-3)+\dfrac{1}{2!}F&#39;&#39;(3)(2-3)^2+\dfrac{1}{3!}F&#39;&#39;&#39;(\xi_1)    (2-3)^3\\F(4)=F(3)+F&#39;(3)(4-3)+\dfrac{1}{2!}F&#39;&#39;(3)(4-3)^2+\dfrac{1}{3!}F&#39;&#39;&#39;(\xi_2)    (4-3)^3\end{align*}\]</span> 注意到 <spanclass="math inline">\(F(2)=F&#39;(3)=0\)</span>，那么上式化为 <spanclass="math inline">\(\begin{cases}0=F(3)+\dfrac{1}{2}F&#39;&#39;(3)-\dfrac{1}{6}F&#39;&#39;&#39;(\xi_1)\\[6pt]F(4)=F(3)+\dfrac{1}{2}F&#39;&#39;(3)+\dfrac{1}{6}F&#39;&#39;&#39;(\xi_2)\end{cases}\)</span> 即 <spanclass="math display">\[F(4)=\dfrac{1}{6}\qty(F&#39;&#39;&#39;(\xi_1)+F&#39;&#39;&#39;(\xi_2))\]</span>因为 <spanclass="math inline">\(F&#39;&#39;&#39;(x)=f&#39;&#39;(x)\)</span> 在<span class="math inline">\([2,4]\)</span> 上连续，故 <spanclass="math inline">\(F&#39;&#39;&#39;(x)\)</span> 在 <spanclass="math inline">\([2,4]\)</span> 上有最大值 <spanclass="math inline">\(M\)</span> 和最小值 <spanclass="math inline">\(m\)</span>，使得 <spanclass="math display">\[m\leqslant\dfrac{1}{2}\qty(F&#39;&#39;&#39;(\xi_1)+F&#39;&#39;&#39;(\xi_2))\leqslantM\]</span> 又由连续函数的介值定理知 <spanclass="math inline">\(\exists\xi\in(\xi_1,\xi_2)\subset(2,4)\)</span>，使得<br /><spanclass="math display">\[F&#39;&#39;&#39;(\xi)=\dfrac{1}{2}\qty(F&#39;&#39;&#39;(\xi_1)+F&#39;&#39;&#39;(\xi_2))\]</span>故 <spanclass="math inline">\(F(4)=\dfrac{1}{3}\cdot\dfrac{1}{2}\qty(F&#39;&#39;&#39;(\xi_1)+F&#39;&#39;&#39;(\xi_2))=\dfrac  {1}{3}F&#39;&#39;&#39;(\xi)\)</span>，则<span class="math display">\[F&#39;&#39;&#39;(\xi)=3F(4)\Rightarrowf&#39;&#39;(\xi)=3\int_{2}^{4}f(x)\dd x.\]</span></p><h2 id="例题-3">例题 3</h2><p>设 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([-1,1]\)</span> 二阶导函数连续，证明: <spanclass="math inline">\(\exists\xi\in[-1,1]\)</span>，使得 <spanclass="math display">\[\displaystyle\int_{-1}^{1}xf(x)\ddx=\dfrac{1}{3}[2f&#39;(\xi)+\xi f&#39;&#39;(\xi)].\]</span></p><h3 id="解答-2">解答</h3><p>构造 <span class="math inline">\(F(x)=xf(x)\)</span>，那么 <spanclass="math inline">\(F(x)\)</span> 在 <spanclass="math inline">\([-1,1]\)</span> 二阶导函数连续，并且 <spanclass="math display">\[F&#39;(x)=f(x)+xf&#39;(x),~F&#39;&#39;(x)=2f&#39;(x)+xf&#39;&#39;(x)\]</span>又由 Taylor 展开得， <spanclass="math display">\[F(x)=F(0)+F&#39;(0)x+\dfrac{1}{2!}F&#39;&#39;(\thetax)x^2~ \theta\in(0,1)\]</span> 且 <spanclass="math inline">\(F(0)=0,F&#39;(0)=f(0)x\)</span>，于是 <spanclass="math inline">\(F(x)=f(0)x+\dfrac{1}{2}F&#39;&#39;(\thetax)x^2\)</span>，两边对 <span class="math inline">\(x\)</span>积分，则有， <span class="math display">\[\int_{-1}^{1}F(x)\ddx=\int_{-1}^{1}f(0)x\dd x+\dfrac{F&#39;&#39;(\thetax)}{2}\int_{-1}^{1}x^2\dd x=\dfrac{F&#39;&#39;(\thetax)}{2}\int_{-1}^{1}x^2\dd x\]</span> 记 <spanclass="math inline">\(m=\min\limits_{0\leqslant x\leqslant1}F&#39;&#39;(x),~M=\max\limits_{0\leqslant x\leqslant1}F&#39;&#39;(x)\)</span>，于是 <spanclass="math display">\[m\int_{-1}^{1}x^2\dd x\leqslant\int_{-1}^{1}F&#39;&#39;(\theta x)x^2\dd x\leqslant M\int_{-1}^{1}x^2\ddx\]</span> 即 <spanclass="math inline">\(\dfrac{2}{3}m\leqslant\displaystyle\int_{-1}^{1}F&#39;&#39;(\thetax)x^2\dd x\leqslant \dfrac{2}{3}M\)</span>， 因此有 <spanclass="math inline">\(\displaystyle m\leqslant \int_{-1}^{1}F(x)\ddx\leqslant M\)</span>，对 <spanclass="math inline">\(F&#39;&#39;(x)\)</span> 利用连续函数的介值定理，即<span class="math inline">\(\exists\xi\in[-1,1]\)</span>，使得 <spanclass="math inline">\(3\displaystyle\int_{-1}^{1}F(x)\ddx=F&#39;&#39;(\xi)\)</span>，即得证.</p><h2 id="例题-4">例题 4</h2><p>设 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([a, b]\)</span> 上有二阶导数，且 <spanclass="math inline">\(f^{\prime \prime}(x)\)</span> 在 <spanclass="math inline">\([a, b]\)</span> 上黎曼可积，证明: <spanclass="math display">\[f(x)=f(a)+f^{\prime}(a)(x-a)+\int_{a}^{x}(x-t)f^{\prime \prime}(t) \dd  t, \forall x \in[a, b] .\]</span></p><h3 id="解答-3">解答</h3><p>由 N-L 公式， <span class="math display">\[\begin{align*}    f(x) &amp; =f(a)+\int_{a}^{x}f&#39;(t)\ddt=f(a)+\int_{a}^{x}f&#39;(a)\dd t+\int_{a}^{x}\ddt\int_{a}^{t}f&#39;&#39;(u)\dd u \\         &amp; =f(a)+f&#39;(a)(x-a)+\int_{a}^{x}\ddt\int_{t}^{x}f&#39;&#39;(u)\dd u=f(a)+f&#39;(a)(x-a)+\int_{a}^{x}(x-t).\end{align*}\]</span></p><h2 id="例题-5">例题 5</h2><p>已知 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span> 上二阶可导，<spanclass="math inline">\(f(a)=f(b)=0\)</span>，试证: <spanclass="math inline">\(\exists \xi\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=\frac{1}{12}f&#39;&#39;(\xi)(a-b)^3.\]</span></p><h3 id="解答-4">解答</h3><p>令 <span class="math inline">\(\displaystyle F(x)=\int_{a}^{x}f(t)\ddt-\frac{1}{2}(x-a)f(x)\)</span>，<spanclass="math inline">\(\displaystyle G(x)=-\frac{1}{12}(x-a)^3\)</span>，在 <span class="math inline">\([a,b]\)</span> 上连续两次应用 Cauchy中值定理， <span class="math display">\[\begin{align*}    \dfrac{\displaystyle\int_{a}^{b}f(x)\ddx-0}{-\dfrac{1}{12}(b-a)^3-0} &amp;=\dfrac{F(b)-F(a)}{G(b)-G(a)}\xlongequal[a\leqslant \xi_1\leqslantb]{\text{Cauchy中值定理}}\dfrac{F&quot;(\xi_1)}{G&#39;(\xi_1)}                                                                                                    \\                                                                          &amp;=\dfrac{\dfrac{1}{2}f(\xi_1)-\dfrac{1}{2}(\xi_1-a)f&#39;(\xi)-0}{-\dfrac{1}{4}(\xi_1-a)^2-0}\xlongequal[a\leqslant\xi\leqslant\xi_1]{\text{Cauchy中值定理}}\dfrac{-\dfrac{1}{2}f&#39;&#39;(\xi)(\xi-a)}{-\dfrac{1}{2}(\xi-a)}=f&#39;&#39;(\xi).\end{align*}\]</span> 此式同乘 <spanclass="math inline">\(\displaystyle-\frac{1}{12}(b-a)^3=\frac{1}{12}(b-a)^3\)</span>，即得所求.</p><h2 id="例题-6">例题 6</h2><p>设函数 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span> 上二阶可导，证明至少存在一点 <spanclass="math inline">\(\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=f(b)(b-a)-f&#39;(b)\dfrac{(b-a)^2}{2}+\dfrac{1}{6}(b-a)^3f&#39;&#39;(\xi).\]</span></p><h3 id="解答-5">解答</h3><p>令 <span class="math inline">\(k\)</span> 为使 <spanclass="math inline">\(\displaystyle \int_{a}^{b}f(x)\ddx=f(b)(b-a)-f&#39;(b)\dfrac{(b-a)^2}{2}+\dfrac{1}{6}(b-a)^3k\)</span>成立的实常数，构造辅助函数 <spanclass="math display">\[F(x)=\int_{a}^{x}f(t)\ddt-f(x)(x-a)+f&#39;(x)\dfrac{(x-a)^2}{2}-\dfrac{1}{6}(x-a)^3k\]</span> 则<span class="math inline">\(F(a)=F(b)=0\)</span>，故由 Rolle 定理知<span class="math inline">\(\exists\xi\in(a,b)\)</span>，使 <spanclass="math inline">\(F&#39;(\xi)=0\)</span>，即 <spanclass="math display">\[F&#39;(\xi)=f&#39;&#39;(\xi)\dfrac{(\xi-a)^2}{2}-\dfrac{1}{2}(\xi-a)^2k=0\]</span>得证 <spanclass="math inline">\(k=f&#39;&#39;(\eta)\)</span>，故得证.</p><h2 id="例题-7">例题 7</h2><p>设函数 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span> 上具有二阶连续的导数，证明存在<span class="math inline">\(\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=(b-a)f\qty(\dfrac{a+b}{2})+\dfrac{1}{24}(b-a)^3f&#39;&#39;(\xi).\]</span></p><h3 id="解答法一">解答：法一</h3><p>将 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\(\dfrac{a+b}{2}\)</span> 处进行 Taylor 展开，有<spanclass="math display">\[f(x)=f\qty(\dfrac{a+b}{2})+f&#39;\qty(\dfrac{a+b}{2})\qty(x-\dfrac{a+b}{2})+\dfrac{f&#39;&#39;(\xi_1)}{2!}\qty(x-\dfrac{a+b}{2})\]</span>因为 <span class="math inline">\(f&#39;&#39;(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span> 上连续，所以存在最小值 <spanclass="math inline">\(m\)</span> 和最大值 <spanclass="math inline">\(M\)</span>，使 <span class="math inline">\(\forallx\in[a,b]\)</span>，<span class="math inline">\(m\leqslantf&#39;&#39;(x) \leqslant M\)</span>，于是 <spanclass="math display">\[m\int_{a}^{b}\qty(x-\dfrac{a+b}{2})^2\ddx\leqslant \int_{a}^{b}f&#39;&#39;(\xi_1)\qty(x-\dfrac{a+b}{2})^2\ddx\leqslant M\int_{a}^{b}\qty(x-\dfrac{a+b}{2})^2\dd x\]</span> 从而<span class="math inline">\(\displaystyle m\leqslant\dfrac{\displaystyle\int_{a}^{b}f&#39;&#39;(\xi_1)\qty(x-\dfrac{a+b}{2})^2\ddx}{\displaystyle \int_{a}^{b}\qty(x-\dfrac{a+b}{2})^2\dd x}\leqslantM\)</span>，故由介值定理知，存在 <spanclass="math inline">\(\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[f&#39;&#39;(\xi)=\dfrac{\displaystyle\int_{a}^{b}f&#39;&#39;(\xi_1)\qty(x-\dfrac{a+b}{2})^2\ddx}{\displaystyle \int_{a}^{b}\qty(x-\dfrac{a+b}{2})^2\dd x}\]</span>即得证 <span class="math inline">\(\displaystyle\int_{a}^{b}f(x)\ddx=(b-a)f\qty(\dfrac{a+b}{2})+\dfrac{1}{24}(b-a)^3f&#39;&#39;(\xi).\)</span></p><h3 id="解答法二">解答：法二</h3><p>令 <span class="math inline">\(\displaystyle F(x)=\int_{a}^{x}f(t)\ddt\)</span>，将 <span class="math inline">\(F(x)\)</span> 在 <spanclass="math inline">\(x_0=\dfrac{a+b}{2}\)</span> 处 Taylor 展开得 <spanclass="math display">\[F(x)  =F\left( x_{0}\right) +F&#39;\left(x_{0}\right) \left( x-x_{0}\right) +\dfrac{F&#39;&#39;(x)  }{2!}\left(x-x_{0}\right) ^{2}+\dfrac{F&#39;&#39;&#39;\left( \xi \right)}{3!}\left( x-x_{0}\right) ^{3}\]</span> 其中 <spanclass="math inline">\(\xi\)</span> 介于 <spanclass="math inline">\(x_0\)</span> 与 <spanclass="math inline">\(x\)</span> 之间，将 <spanclass="math inline">\(x=a\)</span> 和 <spanclass="math inline">\(x=b\)</span> 代入上式，并相减得 <spanclass="math display">\[F\left( b\right) -F\left( a\right) =\left(b-a\right) f\left( \dfrac{a+b}{2}\right) +\dfrac{1}{24}\left( b-a\right)^{3}\dfrac{f&#39;&#39;\left( \xi _{1}\right) +f&#39;&#39;\left( \xi_{2}\right) }{2}\]</span> 其中 <span class="math inline">\(a &lt;\xi_{2} &lt;\dfrac{a+b}{2} &lt;\xi _{1} &lt;b\)</span>，不妨设 <spanclass="math inline">\(f&#39;&#39;(\xi_1)\leqslantf&#39;&#39;(\xi_2)\)</span>，则 <spanclass="math inline">\(f&#39;&#39;(x_1)\leqslant\dfrac{f&#39;&#39;(\xi_1)+f&#39;&#39;(\xi_2)}{2}\leqslantf&#39;&#39;(\xi_2)\)</span>，由导函数 <spanclass="math inline">\(f&#39;&#39;(x)\)</span> 的 Darboux 定理或 <spanclass="math inline">\(f&#39;&#39;(x)\)</span> 的连续性及介值定理知，<span class="math inline">\(\exists\xi\in(\xi_1,\xi_2)\)</span> 或 <spanclass="math inline">\((\xi_2,\xi_1)\subset (a,b)\)</span>，使 <spanclass="math inline">\(f&#39;&#39;(\xi)=\dfrac{f&#39;&#39;(\xi_1)+f&#39;&#39;(\xi_2)}{2}\)</span>，故<span class="math inline">\(\displaystyle\int_{a}^{b}f(x)\ddx=(b-a)f\qty(\dfrac{a+b}{2})+\dfrac{1}{24}(b-a)^3f&#39;&#39;(\xi).\)</span></p><h3 id="解答法三">解答：法三</h3><p>设 <span class="math inline">\(k\)</span> 为使 <spanclass="math inline">\(\displaystyle \int_{a}^{b} f(x) \dd  x=(b-a)f\left(\frac{a+b}{2}\right)+\frac{1}{24}(b-a)^{3} k\)</span>成立的实数，要证结论成立，只需证 <spanclass="math inline">\(k=f&#39;&#39;(\xi)\)</span>，为此构造辅助函数<span class="math display">\[ \displaystyle F(x)=\int_{a}^{x} f(t)\dd  t-(x-a) f\left(\frac{a+x}{2}\right)-\frac{1}{24}(x-a)^{3} k\]</span> 则 <span class="math inline">\(F(a)=F(b)=0\)</span>，故由Rolle 定理，<span class="math inline">\(\exists \eta \in(a,b)\)</span>，使 <spanclass="math inline">\(F^{\prime}(\eta)=0\)</span>，即 <spanclass="math display">\[f(\eta)-f\left(\frac{a+\eta}{2}\right)-\frac{\eta-a}{2}f^{\prime}\left(\frac{a+\eta}{2}\right)-\frac{k}{8}(\eta-a)^{2}=0\]</span> 又将 <span class="math inline">\(f(\eta)\)</span> 在 <spanclass="math inline">\(x=\dfrac{a+\eta}{2}\)</span> 处进行 Taylor展开，有 <spanclass="math display">\[f(\eta)=f\left(\dfrac{a+\eta}{2}\right)+f^{\prime}\left(\frac{a+\eta}{2}\right)\frac{\eta-a}{2}+\frac{f^{\prime \prime}(\xi)}{2!}\left(\frac{\eta-a}{2}\right)^{2}\]</span> 其中 <spanclass="math inline">\(\xi \in\left(\dfrac{a+\eta}{2}, \eta\right)\subset(a, b)\)</span>， 比较上述两式，得 <spanclass="math inline">\(k=f^{\prime \prime}(\xi)\)</span> 故得证.</p><h3 id="解答法四">解答：法四</h3><p>取 <spanclass="math inline">\(\rho\equiv1\)</span>，首先构造数值求积公式 <spanclass="math inline">\(\displaystyle\int_{a}^{b}f(x)\dd x\approxA_0f\qty(\dfrac{a+b}{2})\)</span>，使其具有尽可能高的代数精度， 为此，取<span class="math inline">\(f(x)=1\)</span> 使求积公式精确成立，则有<span class="math display">\[A_0=b-a\]</span> 把 <spanclass="math inline">\(A_0\)</span> 代入求积公式，取 <spanclass="math inline">\(f(x)=x\)</span>，代入验算知求积公式精确成立; 再取<span class="math inline">\(f(x)=x^2\)</span>，求积公式不精确成立，故求积公式 <span class="math inline">\(\displaystyle\int_{a}^{b}f(x)\ddx\approx (b-a)f\qty(\dfrac{a+b}{2})\)</span> 的代数精度为 <spanclass="math inline">\(1\)</span>; 其次，构造一次插值多项式 <spanclass="math display">\[P_1\qty(\dfrac{a+b}{2})=f\qty(\dfrac{a+b}{2}),~P&#39;_1\qty(\dfrac{a+b}{2})=f&#39;\qty(\dfrac{a+b}{2})\]</span>那么 <spanclass="math inline">\(W_2(x)=\qty(x-\dfrac{a+b}{2})^2\)</span> 且不恒为<span class="math inline">\(0\)</span>，又 <spanclass="math display">\[K=\int_{a}^{b}W_2(x)\ddx=\dfrac{1}{12}(b-a)^3\]</span> 那么至少存在一点 <spanclass="math inline">\(\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=(b-a)f\qty(\dfrac{a+b}{2})+\dfrac{f&#39;&#39;(\xi)}{2!}\cdot\dfrac{1}{12}(b-a)^3\]</span>即得待证等式.</p><h2 id="例题-8">例题 8</h2><p>设函数 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span> 上具有二阶连续的导数，证明存在一点<span class="math inline">\(\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=\dfrac{b-a}{2}(f(a)+f(b))-\dfrac{1}{12}f&#39;&#39;(\xi)(b-a)^3.\]</span></p><h3 id="解答法一-1">解答：法一</h3><p>设 <span class="math inline">\(k\)</span> 为使 <spanclass="math inline">\(\displaystyle \int_{a}^{b}f(x)\ddx=\dfrac{b-a}{2}(f(a)+f(b))-\dfrac{1}{12}k(b-a)^3\)</span>成立的实常数，则证 <spanclass="math inline">\(k=f&#39;&#39;(\xi)\)</span>，为此构造辅助函数<span class="math display">\[F(x)=\int_{a}^{x}f(t)\ddt-\dfrac{x-a}{2}(f(a)+f(x))+\dfrac{1}{12}k(x-a)^3\]</span> 那么 <spanclass="math inline">\(F(a)=F(b)=0\)</span>，由 Rolle 定理知，<spanclass="math inline">\(\exists\xi_1\in(a,b)\)</span>，使得 <spanclass="math inline">\(F&#39;(\xi_1)=0\)</span>，又 <spanclass="math display">\[F&#39;(x)=f(x)-\dfrac{1}{2}(f(x)+f(a))-\dfrac{x-a}{2}f&#39;(x)+\dfrac{1}{4}k(x-a)^2\]</span>并且注意到 <spanclass="math inline">\(F&#39;(a)=F&#39;(\xi_1)=0\)</span>，再由 Rolle定理知，<spanclass="math inline">\(\exists\xi\in(a,\xi_1)\subset(a,b)\)</span>，使得<span class="math inline">\(F&#39;&#39;(\xi)=0\)</span>，并且 <spanclass="math display">\[F&#39;&#39;(\xi)=-\dfrac{\xi-a}{2}f&#39;&#39;(\xi)+\dfrac{1}{2}k(\xi-a)=0\]</span>即得证 <span class="math inline">\(k=f&#39;&#39;(\xi).\)</span></p><h3 id="解答法二-1">解答：法二</h3><p>取 <spanclass="math inline">\(\rho(x)\equiv1\)</span>，首先构造数值求积公式<span class="math inline">\(\displaystyle\int_{a}^{b}f(x)\dd x\approxA_0f(a)+A_1f(b)\)</span>，使其具有尽可能高的代数精度，为此， 分别取<span class="math inline">\(f(x)=1,x\)</span> 使求积公式精确成立，则有<span class="math display">\[\left\{\begin{matrix}        A_0  &amp; + &amp; A_1  &amp; = &amp; b-a                \\        aA_0 &amp; + &amp; bA_1 &amp; = &amp; \dfrac{b^2-a^2}{2}    \end{matrix}\right.\Rightarrow A_0=A_1=\dfrac{b-a}{2} \]</span> 把<span class="math inline">\(A_0,~A_1\)</span> 代入求积公式，取 <spanclass="math inline">\(f(x)=x^2\)</span>，代入验算知求积公式精确成立;再取 <span class="math inline">\(f(x)=x^3\)</span>，求积公式不精确成立，故求积公式 <span class="math inline">\(\displaystyle\int_{a}^{b}f(x)\ddx\approx\dfrac{b-a}{2}(f(a)+f(b))\)</span> 的代数精度为 <spanclass="math inline">\(2\)</span>; 其次，构造二次插值多项式 <spanclass="math inline">\(P_1(x)\)</span>，使满足 <spanclass="math display">\[P_1(a)=f(a),~P&#39;_1(b)=f&#39;(b)\]</span> 那么<span class="math inline">\(W_2(x)=(x-a)(x-b)\geqslant 0\)</span>且不恒为 <span class="math inline">\(0\)</span>，又 <spanclass="math display">\[K=\int_{a}^{b}W_2(x)\ddx=-\dfrac{1}{6}(b-a)^3\]</span> 那么至少存在一点 <spanclass="math inline">\(\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=\dfrac{b-a}{2}(f(a)+f(b))-\dfrac{f&#39;&#39;(\xi)}{2!}\cdot\dfrac{1}{6}(b-a)^3\]</span>即得待证等式.</p><h2 id="例题-9">例题 9</h2><p>设函数 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span>上有三阶连续的导数，证明至少存在一点 <spanclass="math inline">\(\eta\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=\dfrac{b-a}{4}\qty[f(a)+3f\qty(\dfrac{a+2b}{3})]+\dfrac{(b-a)^4}{216}f&#39;&#39;&#39;(\eta).\]</span></p><h3 id="解答-6">解答</h3><p>令 <span class="math inline">\(k\)</span> 为使 <spanclass="math inline">\(\displaystyle\int_{a}^{b}f(x)\ddx=\dfrac{b-a}{4}\qty[f(a)+3f\qty(\dfrac{a+2b}{3})]+\dfrac{(b-a)^4}{216}k\)</span>成立的实常数，要证结论成立，只需证 <spanclass="math inline">\(k=f&#39;&#39;&#39;(\eta)\)</span>，为此，将上式右端移到左端，并将 <span class="math inline">\(b\)</span>改写为 <span class="math inline">\(x\)</span>，构造辅助函数 <spanclass="math display">\[F(x)=\int_{a}^{x}f(t)\ddt-\dfrac{x-a}{4}\qty[f(a)+3f\qty(\dfrac{a+2x}{3})]-\dfrac{(x-a)^4}{216}k,~x\in[a,b]\]</span>则 <span class="math inline">\(F(a)=F(b)=0\)</span>，<spanclass="math inline">\(F(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span> 上连续且可导，由 Rolle 定理，<spanclass="math inline">\(\exists\xi_1\in(a,b)\)</span>，使得 <spanclass="math inline">\(F&#39;(\xi_1)=0\)</span>，又 <spanclass="math display">\[F&#39;(x)=f(x)-\dfrac{1}{4}\qty[f(a)+3f\qty(\dfrac{a+2x}{3})]-\dfrac{x-a}{2}f&#39;\qty(\dfrac{a+2x}{3})-\dfrac{(x-a)^3}{54}k\]</span>得 <span class="math inline">\(F&#39;(a)=F&#39;(\xi_1)=0\)</span>，故对<span class="math inline">\(F&#39;(x)\)</span> 在 <spanclass="math inline">\([a,\xi_1]\)</span> 上用 Rolle 定理，得 <spanclass="math inline">\(\exists\xi_2\in(a,\xi_1)\subset(a,b)\)</span>，使得<span class="math inline">\(F&#39;&#39;(\xi_2)=0\)</span>，即 <spanclass="math display">\[F&#39;&#39;(\xi_2)=f&#39;(\xi_2)-f&#39;\qty(\dfrac{a+2\xi_2}{3})-\dfrac{\xi_2-a}{3}f&#39;&#39;\qty(\dfrac{a+2\xi_2}{3})-\dfrac{(\xi_2-a)^2}{18}k=0\]</span>再将 <span class="math inline">\(f&#39;(\xi_2)\)</span> 在 <spanclass="math inline">\(x=\dfrac{a+2\xi_2}{3}\)</span> 处 Taylor 展开，有<spanclass="math display">\[f&#39;(\xi_2)=f&#39;\qty(\dfrac{a+2\xi_2}{3})+f&#39;&#39;\qty(\dfrac{a+2\xi_2}{3})\qty(\xi_2-\dfrac{a+2\xi_2}{3})+\dfrac{1}{2!}f&#39;&#39;&#39;(\eta)\qty(\xi_2-\dfrac{a+2\xi_3}{3})^2\]</span>其中 <spanclass="math inline">\(\eta\in\qty(\dfrac{a+2\xi_2}{3})\subset(a,b)\)</span>，比较上述两式，即得<spanclass="math inline">\(k=f&#39;&#39;&#39;(\eta)\)</span>，故得证.</p><h2 id="例题-10">例题 10</h2><p>设函数 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span>上有三阶连续的导数，证明至少存在一点 <spanclass="math inline">\(\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=\dfrac{b-a}{4}\qty[3f\qty(\dfrac{2a+b}{3})+f(b)]-\dfrac{(b-a)^4}{216}f&#39;&#39;&#39;(\xi).\]</span></p><h3 id="解答-7">解答</h3><p>令 <span class="math inline">\(k\)</span> 为使 <spanclass="math inline">\(\displaystyle \int_{a}^{b}f(x)\ddx=\dfrac{b-a}{4}\qty[3f\qty(\dfrac{2a+b}{3})+f(b)]-\dfrac{(b-a)^4}{216}k\)</span>成立的实常数，要证结论成立，只需证 <spanclass="math inline">\(k=f&#39;&#39;&#39;(\eta)\)</span>，为此，构造辅助函数 <span class="math display">\[F(x)=\int_{x}^{b}f(t)\ddt-\dfrac{b-x}{4}\qty[3f\qty(\dfrac{2x+b}{3})+f(b)]+\dfrac{(b-x)^4}{216}k\]</span>则 <span class="math inline">\(F(a)=F(b)=0\)</span>，<spanclass="math inline">\(F(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span> 上连续且可导，由 Rolle 定理，<spanclass="math inline">\(\exists\xi_1\in(a,b)\)</span>，使得 <spanclass="math inline">\(F&#39;(\xi_1)=0\)</span>，又 <spanclass="math display">\[F&#39;(x)=-f(x)+\dfrac{1}{4}\qty[3f\qty(\dfrac{2x+b}{3})+f(b)]-\dfrac{b-x}{2}f&#39;\qty(\dfrac{2x+b}{3})-\dfrac{(b-x)^3}{54}k\]</span>得 <span class="math inline">\(F&#39;(\xi_1)=F&#39;(b)=0\)</span>，故对<span class="math inline">\(F&#39;(x)\)</span> 在 <spanclass="math inline">\([\xi_1,b]\)</span> 上用 Rolle 定理，得 <spanclass="math inline">\(\exists\xi_2\in(\xi_1,b)\subset(a,b)\)</span>，使得<span class="math inline">\(F&#39;&#39;(\xi_2)=0\)</span>，即 <spanclass="math display">\[F&#39;&#39;(\xi_2)=-f&#39;(\xi_2)+f&#39;\qty(\dfrac{2\xi_2+b}{3})-\dfrac{b-\xi_2}{3}f&#39;&#39;\qty(\dfrac{2\xi_2+b}{3})+\dfrac{(b-\xi_2)^2}{18}k\]</span>再将 <span class="math inline">\(f&#39;(\xi_2)\)</span> 在 <spanclass="math inline">\(x=\dfrac{2\xi_2+b}{3}\)</span> 处 Taylor 展开，有<spanclass="math display">\[f&#39;(\xi_2)=f&#39;\qty(\dfrac{2\xi_2+b}{3})+f&#39;&#39;\qty(\dfrac{2\xi_2+b}{3})\qty(\xi_2-\dfrac{2\xi_2+b}{3})+\dfrac{1}{2!}f&#39;&#39;&#39;(\eta)\qty(\xi_2-\dfrac{2\xi_2+b}{3})^2\]</span>其中 <spanclass="math inline">\(\eta\in\qty(\dfrac{2\xi_2+b}{3})\subset(a,b)\)</span>，比较上述两式，即得<spanclass="math inline">\(k=f&#39;&#39;&#39;(\eta)\)</span>，故得证.</p><h2 id="例题-11">例题 11</h2><p>设函数 <span class="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\([a,b]\)</span> 上具有四阶连续导数，证明存在一点<span class="math inline">\(\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[\int_{a}^{b}f(x)\ddx=\dfrac{b-a}{6}\qty[f(a)+4f\qty(\dfrac{a+b}{2})+f(b)]-\dfrac{(b-a)^5}{2880}f^{(4)}(\xi).\]</span></p><h3 id="解答-8">解答：</h3><p>令 <span class="math inline">\(\begin{cases}        a=c-h \\b=c+h    \end{cases}\Rightarrow \begin{cases}        c=\dfrac{a+b}{2} \\[6pt]        h=\dfrac{b-a}{2}    \end{cases}\)</span> 那么原式等价于 <spanclass="math display">\[\int_{c-h}^{c+h}f(x)\ddx=\dfrac{h}{3}\qty[f(c-h)+4(c)+f(c+h)]-\dfrac{h^5}{90}f^{(4)}(\xi)\]</span>设 <span class="math inline">\(k\)</span> 为使上式成立的实常数，并构造<span class="math display">\[F(x)=\int_{c-x}^{c+x}f(t)\ddt-\dfrac{x}{3}\qty[f(c-x)+4(c)+f(c+x)]+\dfrac{x^5}{90}k\]</span> 下证<span class="math inline">\(k=f^{(4)}(\xi)\)</span>，因为 <spanclass="math inline">\(F(0)=F(x)=0\)</span>，由 Rolle 定理得，<spanclass="math inline">\(\exists \xi_1\in(0,x)\)</span>，使得 <spanclass="math inline">\(F&#39;(\xi_1)=0\)</span> 又 <spanclass="math display">\[\begin{align*}    F&#39;(x) &amp;=f(c+x)+f(c-x)-\dfrac{1}{3}\qty[f(c-x)+4f(c)+f(c+x)]-\dfrac{x}{3}\qty[-f&#39;(c-x)+f&#39;(c+x)]+\dfrac{x^4}{18}k\\          &amp;=\dfrac{2}{3}\qty[f(c+x)+f(c-x)]+\dfrac{x}{3}\qty[f&#39;(c-x)-f&#39;(c+x)]+\dfrac{x^4}{18}k-\dfrac{4}{3}f(c)\end{align*}\]</span> 因为 <spanclass="math inline">\(F&#39;(0)=F&#39;(\xi_1)\)</span>，由 Rolle定理得，<spanclass="math inline">\(\exists\xi_2\in(0,\xi_1)\)</span>，使得 <spanclass="math inline">\(F&#39;&#39;(\xi_2)=0\)</span>，且 <spanclass="math display">\[\begin{align*}    F&#39;&#39;(x) &amp;=\dfrac{2}{3}\qty[f&#39;(c+x)-f&#39;(c-x)]+\dfrac{1}{3}\qty[f&#39;(c-x)-f&#39;(c+x)]+\dfrac{x}{3}\qty[-f&#39;&#39;(c-x)-f&#39;&#39;(c+x)]+\dfrac{2x^3}{9}k\\           &amp;=\dfrac{1}{3}\qty[f&#39;(c+x)-f&#39;(c-x)]-\dfrac{x}{3}\qty[f&#39;&#39;(c-x)+f&#39;&#39;(c+x)]+\dfrac{2x^3}{9}k\end{align*}\]</span> 又因为 <spanclass="math inline">\(F&#39;&#39;(0)=F&#39;&#39;(\xi_2)\)</span>，由Rolle 定理得，<spanclass="math inline">\(\exists\xi_3\in(0,\xi_2)\)</span>，使得 <spanclass="math inline">\(F&#39;&#39;&#39;(\xi_3)=0\)</span>，且 <spanclass="math display">\[\begin{align*}    F&#39;&#39;&#39;(x) &amp;=\dfrac{1}{3}\qty[f&#39;&#39;(c+x)+f&#39;&#39;(c-x)]-\dfrac{1}{3}\qty[f&#39;&#39;(c-x)+f&#39;&#39;(c+x)]-\dfrac{x}{3}\qty[-f&#39;&#39;&#39;(c-x)+f&#39;&#39;&#39;(c+x)]+\dfrac{2x^2}{3}k\\            &amp;=\dfrac{x}{3}\qty[f&#39;&#39;&#39;(c-x)-f&#39;&#39;&#39;(c+x)]+\dfrac{2x^2}{3}k\end{align*}\]</span> 由 Lagrange 中值定理得，<spanclass="math inline">\(\exists\xi\in(c-\xi_3,c+\xi_3)\)</span>，使得<spanclass="math inline">\(f&#39;&#39;&#39;(c-\xi_3)-f&#39;&#39;&#39;(c+\xi_3)=-2\xi_3f^{(4)}(\xi)\)</span>，那么<spanclass="math display">\[-\dfrac{2}{3}\xi_3^2f^{(4)}(\xi)+\dfrac{2}{3}\xi_3^2k=0\Rightarrowk=f^{(4)}(\xi)\]</span> 得证 <spanclass="math inline">\(k=f^{(4)}(x)\)</span>，即原命题成立.</p><h2 id="例题-12">例题 12</h2><p>设 <span class="math inline">\(f(x)\in C^4[0,1]\)</span>，且满足<span class="math inline">\(\displaystyle \int_{0}^{1}f(x)\ddx+3f\qty(\dfrac{1}{2})=8\int_{\frac{1}{4}}^{\frac{3}{4}}f(x)\ddx\)</span>，证明: <span class="math inline">\(\existsc\in(0,1)\)</span>，使得 <spanclass="math inline">\(f^{(4)}(c)=0.\)</span></p><h3 id="解答-9">解答</h3><p>因为 <span class="math inline">\(\displaystyle\int_{0}^{1}f(x)\ddx\xlongequal{x=t+\frac{1}{2}}\int_{-\frac{1}{2}}^{\frac{1}{2}}f\qty(t+\dfrac{1}{2})\ddt,~\int_{\frac{1}{4}}^{\frac{3}{4}}f(x)\ddx\xlongequal{x=\frac{t}{2}+\frac{1}{2}}\dfrac{1}{2}\int_{-\frac{1}{2}}^{\frac{1}{2}}f\qty(\dfrac{t}{2}+\dfrac{1}{2})\ddt\)</span>，所以 <spanclass="math display">\[\int_{-\frac{1}{2}}^{\frac{1}{2}}f(t+\dfrac{1}{2})\ddt-4\int_{\frac{1}{2}}^{\frac{1}{2}}f\qty(\dfrac{t}{2}+\dfrac{1}{2})\dd t+3f\qty(\dfrac{1}{2})=0\]</span> 令 <spanclass="math inline">\(g(x)=f\qty(x+\dfrac{1}{2})+f\qty(-x+\dfrac{1}{2})\)</span>，<spanclass="math inline">\(h(x)=g(x)-4g\qty(\dfrac{x}{2})\)</span>，那么<spanclass="math display">\[h(0)=-3g(0)=-6f\qty(\dfrac{1}{2})\Rightarrowf\qty(\dfrac{1}{2})=-\dfrac{1}{2}h(0)\]</span> 那么 <spanclass="math display">\[\begin{align*}    \int_{-\frac{1}{2}}^{\frac{1}{2}}f\qty(t+\dfrac{1}{2})\ddt-4\int_{\frac{1}{2}}^{\frac{1}{2}}f\qty(\dfrac{t}{2}+\dfrac{1}{2})\dd t-\dfrac{1}{2}h(0)=0    \Rightarrow \int_{0}^{\frac{1}{2}}h(t)\ddt-\dfrac{1}{2}h(0)=0\Rightarrow\dfrac{1}{\dfrac{1}{2}-0}\int_{0}^{\frac{1}{2}}h(t)\dd t=h(0)\end{align*}\]</span> 因为 <spanclass="math inline">\(m=\min\limits_{x\in[0,1]}h(x)\leqslanth(0)\leqslant \max\limits_{x\in[0,1]}h(x)=M\)</span>，所以 <spanclass="math inline">\(\exists\xi_1\in(0,\dfrac{1}{2})\)</span>，使得<span class="math inline">\(h&#39;(\xi_1)=0\)</span>，又 <spanclass="math display">\[h&#39;(x)=g&#39;(x)-2g&#39;\qty(\dfrac{x}{2}),g&#39;(x)=f&#39;\qty(x+\dfrac{1}{2})-f\qty(-x+\dfrac{1}{2})\]</span>所以 <span class="math inline">\(h&#39;(0)=0=h&#39;(\xi_1)\)</span>，由Rolle 定理知，<spanclass="math inline">\(\exists\xi_2\in(0,\xi_1)\subset\qty(0,\dfrac{1}{2})\)</span>，使得 <spanclass="math inline">\(h&#39;&#39;(\xi_2)=0\)</span>，又 <spanclass="math display">\[h&#39;&#39;(x)=g&#39;&#39;(x)-g&#39;&#39;\qty(\dfrac{x}{2}),g&#39;&#39;(x)=f&#39;&#39;\qty(x+\dfrac{1}{2})+f&#39;&#39;\qty(-x+\dfrac{1}{2})\]</span>所以 <spanclass="math inline">\(h&#39;&#39;(\xi_2)=g&#39;&#39;(\xi_2)=g&#39;&#39;\qty(\dfrac{\xi_2}{2})\)</span>，由Rolle 定理知，<spanclass="math inline">\(\exists\xi_3\in\qty(\dfrac{\xi_2}{2},\xi_2)\subset\qty(0,\dfrac{1}{2})\)</span>，使得<span class="math inline">\(g&#39;&#39;&#39;(\xi_3)=0\)</span>，而 <spanclass="math display">\[g&#39;&#39;&#39;(x)=f&#39;&#39;&#39;\qty(x+\dfrac{1}{2})-f&#39;&#39;&#39;\qty(-x+\dfrac{1}{2})\]</span>所以 <spanclass="math inline">\(f&#39;&#39;&#39;\qty(\xi_3+\dfrac{1}{2})=f&#39;&#39;&#39;\qty(-\xi_3+\dfrac{1}{2})\)</span>，再由Rolle 定理知，<span class="math inline">\(\existsc\in\qty(-\xi_3+\dfrac{1}{2},\xi_3+\dfrac{1}{2})\subset(0,1)\)</span>使得 <span class="math inline">\(f^{(4)}(c)=0.\)</span></p>]]></content>
    
    
    <categories>
      
      <category>数学笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>高等数学</tag>
      
      <tag>数学技巧</tag>
      
      <tag>考研数学</tag>
      
      <tag>中值定理</tag>
      
      <tag>积分证明</tag>
      
      <tag>一题多解</tag>
      
      <tag>一元函数积分学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stolz 的应用</title>
    <link href="/2024/05/02/applicationsOfStolz/"/>
    <url>/2024/05/02/applicationsOfStolz/</url>
    
    <content type="html"><![CDATA[<h1 id="stolz-的应用">Stolz 的应用</h1><h2 id="例题-1">例题 1</h2><p>对于数列 <spanclass="math inline">\(x_0=a,0&lt;a&lt;\dfrac{\pi}{2},x_n=\sinx_{n-1}~  (n=1,2,\cdots)\)</span>，证明: <spanclass="math display">\[\lim_{n\to\infty}x_n=0,~\lim_{n\to\infty}\sqrt{\frac{n}{3}}x_n=1.\]</span></p><h3 id="解答">解答</h3><p>因为 <spanclass="math inline">\(0&lt;a&lt;\dfrac{\pi}{2},~x_0=a\)</span>，递推可知<span class="math display">\[0&lt;x_n=\sinx_{n-1}&lt;x_{n-1}&lt;\dfrac{\pi}{2}~  (n=1,2,\cdots)\]</span></p><p><span class="math inline">\(\{x_n\}\)</span> 单调递减且有下界 <spanclass="math inline">\(0\)</span>，<spanclass="math inline">\(\lim\limits_{n\to\infty}x_n\)</span> 存在. 记<spanclass="math inline">\(\displaystyle\lim_{n\to\infty}x_n=A\)</span>，知<span class="math inline">\(A=\sin A\Rightarrow A=0\)</span>，<spanclass="math inline">\(\displaystyle\lim_{n\to\infty}x_n=0.\)</span></p><p>要证 <span class="math inline">\(\displaystyle\lim_{n\to\infty}\sqrt{\frac{n}{3}}x_n=1\)</span>，即证 <spanclass="math inline">\(\displaystyle\lim_{n\to\infty}\frac{n}{\dfrac{1}{x_n^2}}=3\)</span></p><p><span class="math display">\[\begin{align*}    \lim _{n\rightarrow \infty }\dfrac{n}{\dfrac{1}{x_{n}^{2}}} &amp;\xlongequal[]{\text{Stolz}}\lim _{n\rightarrow \infty }\dfrac{n-\left(n-1\right) }{\dfrac{1}{x_{n}^{2}}-\dfrac{1}{x_{n-1}^{2}}}=\lim_{n\rightarrow \infty }\dfrac{1}{\dfrac{1}{\sin^{2}x_{n-1}}-\dfrac{1}{x_{n-1}^{2}}}=\lim _{n\rightarrow \infty}\dfrac{x_{n-1}^{2}\sin ^{2}x_{n}-1}{x_{n-1}^{2}-\sin ^{2}x_{n-1}} \\                                                                              &amp;=\lim _{x\rightarrow 0}\dfrac{x^{2}\sin ^{2}x}{x^{2}-\sin ^{2}x}=\lim_{x\rightarrow 0}\dfrac{x^{4}}{\left( x+\sin x\right) \left( x-\sinx\right) }=\lim _{x\rightarrow 0}\dfrac{x^{4}}{\left( 2x+o\left(x\right) \right) \left( \dfrac{x3}{6}+o\left( x^{3}\right) \right)}                                          \\                                                                              &amp;=\lim _{x\rightarrow 0}\dfrac{1}{\left( 2+o\left( 1\right) \right)\left( \dfrac{1}{6}+o\left( 1\right) \right) }=3.\end{align*}\]</span></p><p>得证 <span class="math inline">\(\displaystyle\lim_{n\to\infty}\sqrt{\frac{n}{3}}x_n=1.\)</span></p><h2 id="例题-2">例题 2</h2><p>设 <spanclass="math inline">\(0&lt;a_1&lt;1,a_{n+1}=a_n(1-a_n)~  (\foralln\in\mathbb{N})\)</span>，证明: <spanclass="math inline">\(\displaystyle\lim_{n\to\infty}na_n=1.\)</span></p><h3 id="解答-1">解答</h3><p>由 <span class="math inline">\(0&lt;x_1&lt;1\)</span> 及 <spanclass="math inline">\(x_2=x_1(1-x_1)\)</span> 知， <spanclass="math inline">\(0&lt;x_2&lt;1\)</span>，用数学归纳法可证: <spanclass="math inline">\(\foralln\in\mathbb{N}^*:0&lt;x_n&lt;1\)</span>，于是 <spanclass="math inline">\(0&lt;\dfrac{x_{n+1}}{x_{n}}=1-x_n&lt;1~  (n=1,2,\cdots)\)</span>，从而 <span class="math inline">\(\{x_n\}\searrow 0\)</span>，不妨设<spanclass="math inline">\(\displaystyle\lim_{n\to\infty}x_n=A\)</span>，递推关系式两边取极限，得<span class="math inline">\(A=A(1-A)\)</span>，解得 <spanclass="math inline">\(A=0.\)</span> 令 <spanclass="math inline">\(b_n=\dfrac{1}{x_n}\)</span>，则 <spanclass="math inline">\(\displaystyle\lim_{n\to\infty}b_n=+\infty\)</span>，且数列<span class="math inline">\(\{b_n\}\)</span> 是严格单调递增，故由 Stolz定理</p><p><span class="math display">\[\displaystyle\lim _{n\rightarrow \infty}nx_{n}=\lim _{n\rightarrow \infty }\dfrac{n}{\dfrac{1}{x_{n}}}=\lim_{n\rightarrow \infty }\dfrac{n}{b_{n}}=\lim _{n\rightarrow \infty}\dfrac{1}{b_{n+1}-b_{n}}=\lim _{n\rightarrow \infty }\left(1-x_{n}\right) =1.\]</span></p><h2 id="例题-3">例题 3</h2><p>设 <spanclass="math inline">\(x_1&gt;0,x_{n+1}=\ln(1+x_n)~  (n=1,2,\cdots)\)</span>，求<span class="math inline">\(\lim\limits_{n\to\infty}nx_n.\)</span></p><h3 id="解答-2">解答</h3><p><spanclass="math inline">\(x_2=\ln(1+x_1)&gt;0\)</span>，用数学归纳法可证<span class="math inline">\(\forall n\in\mathbb{N}^*:x_n&gt;0\)</span>，又 <spanclass="math inline">\(x_1&gt;0,x_{n+1}=\ln(1+x_n)&lt;x_n\)</span>，故数列<span class="math inline">\(\{x_n\}\searrow 0\)</span>，那么 <spanclass="math display">\[\begin{align*}        \lim _{n\rightarrow \infty }nx_{n} &amp; =\lim _{n\rightarrow\infty }\dfrac{n}{\dfrac{1}{x_{n}}}\xlongequal[]{\text{Stolz}}\lim_{n\rightarrow \infty}\dfrac{1}{\dfrac{1}{x_{n}}-\dfrac{1}{x_{n}-1}}=\lim _{n\rightarrow\infty }\dfrac{1}{\dfrac{1}{\ln \left( 1+x_{n-1}\right)}-\dfrac{1}{x_{n-1}}} \\                                           &amp; =\lim _{n\rightarrow\infty }\dfrac{x_{n-1}\ln \left( 1+x_{n-1}\right) }{x_{n-1}-\ln \left(1+x_{n-1}\right) }=\lim _{n\rightarrow \infty}\dfrac{x_{n-1}^{2}}{\dfrac{1}{2}x_{n-1}^{2}}=2.    \end{align*}\]</span></p><h2 id="例题-4">例题 4</h2><p>序列 <spanclass="math inline">\(a_{ij}=\dfrac{i+j}{i^2+j^2}\)</span>，求极限 <spanclass="math inline">\(\displaystyle\lim_{n\to\infty}\dfrac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{n}a_{ij}.\)</span></p><h3 id="解答-3">解答</h3><p>由 Stolz (<span class="math inline">\(*/\infty\)</span> 型) 得(以下的括号不为矩阵符号) <span class="math display">\[\begin{align*}             &amp; \begin{pmatrix}                          &amp; \dfrac{1+1}{1^2+1^2}       &amp; + &amp;\dfrac{1+2}{1^2+2^2}       &amp; + &amp; \cdots &amp; + &amp;\dfrac{1+n}{1^2+n^2}       &amp; + &amp;\dfrac{1+n+1}{1^2+(n+1)^2}       \\                   +      &amp; \dfrac{2+1}{2^2+1^2}       &amp; + &amp;\dfrac{2+2}{2^2+2^2}       &amp; + &amp; \cdots &amp; + &amp;\dfrac{2+n}{2^2+n^2}       &amp; + &amp;\dfrac{2+n+1}{2^2+(n+1)^2}       \\                   \vdots &amp; \vdots                     &amp;   &amp;\vdots                     &amp;   &amp;        &amp;   &amp;\vdots                     &amp;   &amp;\vdots                           \\                   +      &amp; \dfrac{n+1}{n^2+1^2}       &amp; + &amp;\dfrac{n+2}{n^2+2^2}       &amp; + &amp; \cdots &amp; + &amp;\dfrac{n+n}{n^2+n^2}       &amp; + &amp;\dfrac{n+n+1}{n^2+(n+1)^2}       \\                   +      &amp; \dfrac{n+1+1}{(n+1)^2+1^2} &amp; + &amp;\dfrac{n+1+2}{(n+1)^2+2^2} &amp; + &amp; \cdots &amp; + &amp;\dfrac{n+1+n}{(n+1)^2+n^2} &amp; + &amp;\dfrac{n+1+n+1}{(n+1)^2+(n+1)^2}               \end{pmatrix} \\             &amp; -            \begin{pmatrix}                       &amp; \dfrac{1+1}{1^2+1^2} &amp; + &amp;\dfrac{1+2}{1^2+2^2} &amp; + &amp; \cdots &amp; + &amp;\dfrac{1+n}{1^2+n^2} \\                +      &amp; \dfrac{2+1}{2^2+1^2} &amp; + &amp;\dfrac{2+2}{2^2+2^2} &amp; + &amp; \cdots &amp; + &amp;\dfrac{2+n}{2^2+n^2} \\                \vdots &amp; \vdots               &amp;   &amp;\vdots               &amp;   &amp;        &amp;   &amp;\vdots               \\                +      &amp; \dfrac{n+1}{n^2+1^2} &amp; + &amp;\dfrac{n+2}{n^2+2^2} &amp; + &amp; \cdots &amp; + &amp;\dfrac{n+n}{n^2+n^2}            \end{pmatrix}            =2\left[ \sum ^{n}_{k=1}\dfrac{(n+1) +k}{(n+1)^{2}+k^{2}}\right] +\dfrac{1}{n+1}.        \end{align*}\]</span> <spanclass="math display">\[\begin{align*}        \lim _{n\rightarrow \infty }\dfrac{1}{n}\sum ^{n}_{i=1}\sum^{n}_{j=1}\dfrac{i+j}{i^{2}+j^{2}} &amp; =\lim _{n\rightarrow \infty}\left( \sum ^{n+1}_{i=1}\sum ^{n+1}_{j=1}-\sum ^{n}_{i=1}\sum^{n}_{j=1}\right) \dfrac{i+j}{i^{2}+j^{2}}=\lim _{n\rightarrow \infty}\left[ 2\left( \sum ^{n}_{k=1}\dfrac{(n+1) +k}{(n+1) ^{2}+k^{2}}\right)+\dfrac{1}{n+1}\right] \\                                                                                                       &amp;=\lim _{n\rightarrow \infty }\left[ \dfrac{2}{n+1}\left( \sum^{n}_{k=1}\dfrac{1+\dfrac{k}{n+1}}{1+\left( \dfrac{k}{n+1}\right)^{2}}\right) +\dfrac{1}{n+1}\right] =2\int _{0}^{1}\dfrac{1+x}{1+x^{2}}\mathrm{d} x=\dfrac{\pi}{2}+\ln 2.    \end{align*}\]</span></p>]]></content>
    
    
    <categories>
      
      <category>数学笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Stolz</tag>
      
      <tag>高等数学</tag>
      
      <tag>数学技巧</tag>
      
      <tag>极限的求法</tag>
      
      <tag>考研数学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>两点三次 Hermite 插值</title>
    <link href="/2024/05/02/twoPointTripleHermiteInterpolation/"/>
    <url>/2024/05/02/twoPointTripleHermiteInterpolation/</url>
    
    <content type="html"><![CDATA[<h1 id="两点三次-hermite-插值">两点三次 Hermite 插值</h1><h2 id="基函数">基函数</h2><p>采用基函数方法，令</p><p><spanclass="math display">\[H_3(x)=\alpha_k(x)y_k+\alpha_{k+1}(x)y_{k+1}+\beta_k(x)m_k+\beta_{k+1}(x)m_{k+1}\]</span></p><p>其中 <spanclass="math inline">\(\alpha_k(x),\alpha_{k+1}(x),\beta_k(x),\beta_{k+1}(x)\)</span>是关于点 <span class="math inline">\(x_k\)</span> 及 <spanclass="math inline">\(x_{k+1}\)</span> 的三次 Hermite插值基函数，它们应分别满足以下条件:</p><p><span class="math display">\[\begin{array}{lll}            \alpha _k(x_k)=1                        &amp; \alpha_k(x_{k+1})=0     &amp; \alpha _k&#39;(x_k)=\alpha&#39;_k(x_{k+1})=0         \\            \alpha _{k+1}(x_k)=0                    &amp; \alpha_{k+1}(x_{k+1})=1 &amp; \alpha&#39; _{k+1}(x_k)=\alpha&#39;_{k+1}(x_{k+1})=0 \\            \beta_k(x_k)=\beta_k(x_{k+1})=0         &amp;\beta&#39;_k(x_k)=1          &amp;\beta&#39;_k(x_{k+1})=0                           \\            \beta_{k+1}(x_k)=\beta_{k+1}(x_{k+1})=0 &amp;\beta&#39;_{k+1}(x_k)=0      &amp; \beta&#39;_{k+1}(x_{k+1})=1        \end{array}\]</span></p><p>解得基函数，那么有</p><p><spanclass="math display">\[H_3(x)=\left(1+2\dfrac{x-x_k}{x_{k+1}-x_k}\right)\left(\dfrac{x-x_{k+1}}{x_k-x_{k+1}}\right)^2y_k+\left(1+2\dfrac{x-x_{k+1}}{x_k-x_{k+1}}\right)\left(\dfrac{x-x_k}{x_{k+1}-x_k}\right)^2y_{k+1}+(x-x_k)\left(\dfrac{x-x_{k+1}}{x_k-x_{k+1}}\right)^2m_k+(x-x_{k+1})\left(\dfrac{x-x_k}{x_{k+1}-x_k}\right)^2m_{k+1}.\]</span></p><h2 id="例题-1">例题 1</h2><p>若函数 <span class="math inline">\(f(x)\text{ 在 }[a,b]\)</span>上三阶可导，且 <spanclass="math inline">\(f(a)=c,f(b)=d,f&#39;(a)=e,f&#39;(b)=f\)</span>，则<span class="math inline">\(\exists\xi\in(a,b)\)</span>，使得 <spanclass="math display">\[f&#39;&#39;&#39;(\xi)=6\dfrac{f(b-a)-2(d-c)+e(b-a)}{(b-a)^3}.\]</span></p><h3 id="解答">解答</h3><p>作三次 Hermite 插值多项式:</p><p><spanclass="math display">\[H_3(x)=c+e(x-a)+\dfrac{(d-c)-e(b-a)}{(b-a)^2}(x-a)^2+\dfrac{f(b-a)-2(d-c)+e(b-a)}{(b-a)^3}(x-a)^2(x-b)\]</span></p><p>则 <span class="math inline">\(H_3(x)\)</span> 与 <spanclass="math inline">\(f(x)\)</span> 在 <spanclass="math inline">\(a,b\)</span> 两点有相同的函数值与导数值，设 <spanclass="math inline">\(F(x)=f(x)-H_3(x)\)</span>，则 <spanclass="math inline">\(F(a)=F(b)=0\)</span>，由 Rolle 定理，<spanclass="math inline">\(\exists\xi_1\in(a,b)\)</span>，使得 <spanclass="math inline">\(F&#39;(\xi_1)=0\)</span>， 由于</p><p><spanclass="math display">\[F&#39;(x)=f&#39;(x)-H_3&#39;(x)=f&#39;(x)+e+2\dfrac{(d-c)-e(b-a)}{(b-a)^2}(x-a)+\dfrac{f(b-a)-2(d-c)+e(b-a)}{(b-a)^3}\left[2(x-a)(x-b)+(x-a)^2\right]\]</span></p><p>则 <span class="math inline">\(F&#39;(a)=F&#39;(b)=0\)</span>，在<span class="math inline">\([a,\xi_1]\)</span> 和 <spanclass="math inline">\([\xi_1,b]\)</span> 上应用 Rolle 定理，则 <spanclass="math inline">\(\exists\xi_2\in(a,\xi_1),\xi_3\in(\xi_1,b)\)</span>，使得</p><p><spanclass="math display">\[F&#39;&#39;(\xi_2)=F&#39;&#39;(\xi_3)=0\]</span></p><p>最后在 <span class="math inline">\([\xi_2,\xi_3]\)</span> 上应用Rolle 定理，即 <spanclass="math inline">\(\exists\xi\in(\xi_2,\xi_3)\)</span>，使得 <spanclass="math inline">\(F&#39;&#39;&#39;(\xi)=0\)</span>，即得证.</p><h2 id="例题-2">例题 2</h2><p>设函数 <span class="math inline">\(f\in C[0,1]\capD^3(0,1),~f(0)=2,~f(1)=1,~f&#39;(0)=0,~f&#39;(1)=4\)</span> 证明:存在一点 <span class="math inline">\(\xi\in(0,1)\)</span> 使得 <spanclass="math inline">\(f&#39;&#39;&#39;(\xi)=24+24\xi.\)</span></p><h3 id="解答-1">解答</h3><p>令 <span class="math inline">\(g(x)=f(x)-x^4\)</span>，则 <spanclass="math inline">\(g\in C[0,1]\cap D^3(0,1)\)</span> 那么 <spanclass="math inline">\(\begin{cases}            x_k=0  , &amp; x_{k+1}=1 \\            y_k=2  , &amp; y_{k+1}=0 \\            m_k=0  , &amp; m_{k+1}=0        \end{cases}\)</span>，因此</p><p><spanclass="math display">\[H_3(x)=2(1+x)(x-1)^2=4x^3-6x^2+2\]</span></p><p>构造 <span class="math inline">\(F(x)=g(x)-H_3(x)\)</span> 有 <spanclass="math inline">\(F(0)=F(1)=0\)</span>，由 Rolle 定理 <spanclass="math inline">\(\exists\xi_1\in(0,1)\)</span> 使得 <spanclass="math inline">\(F&#39;(\xi_1)=0\)</span>， 又 <spanclass="math inline">\(F&#39;(0)=F&#39;(\xi_1)=F&#39;(1)=0\)</span>，由Rolle 定理得 <span class="math inline">\(\exists\xi_2\in(0,\xi_1),\xi_3\in(\xi_1,1)\)</span> 使得 <spanclass="math inline">\(F&#39;&#39;(\xi_i)=0,i=2,3\)</span>， 再根据 Rolle定理得 <spanclass="math inline">\(\exists\xi\in(\xi_2,\xi_3)\subset(0,1)\)</span>使得 <span class="math inline">\(F&#39;&#39;&#39;(\xi)=0\)</span> 即</p><p><spanclass="math display">\[f&#39;&#39;&#39;(\xi)-4!\xi-24=0\Rightarrowf&#39;&#39;&#39;(\xi)=24\xi+24.\]</span></p>]]></content>
    
    
    <categories>
      
      <category>数学笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>高等数学</tag>
      
      <tag>数学技巧</tag>
      
      <tag>考研数学</tag>
      
      <tag>中值定理</tag>
      
      <tag>Hermite 插值</tag>
      
      <tag>一元函数微分学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HarmonyOS 应用开发</title>
    <link href="/2024/05/02/harmonyOsApplicationDevelopment/"/>
    <url>/2024/05/02/harmonyOsApplicationDevelopment/</url>
    
    <content type="html"><![CDATA[<h1 id="harmonyos应用开发">HarmonyOS应用开发</h1><h2 id="第五章-ability基础知识">第五章 Ability基础知识</h2><h3 id="ability概述">Ability概述</h3><ul><li><p>一个HarmonyOS应用可以具备多少种能力，就会包含多少个Ability</p></li><li><p>FA</p><ul><li>Page模板是FA唯一支持的模板</li><li>一个Page实例可以包含一组相关页面，每个页面用一个AbilitySlice实例表示</li><li>FA就是承担前端与用户交互的</li></ul></li><li><p>PA</p><ul><li>Service模板：用于提供后台运行任务的能力</li><li>Data模板：用于对外部提供统一的数据访问抽象</li></ul></li><li><p>Ability的配置</p><ul><li>通过配置Ability元素中的type属性来指定Ability模板类型</li></ul></li></ul><h3 id="ability的三层架构">Ability的三层架构</h3><ul><li>Page Ability：代表表示层</li><li>Service Ability：代表业务层</li><li>Data Ability：代表数据访问层</li></ul><h3 id="page-ability">Page Ability</h3><ul><li><p>Page间的导航可以使用startAbility()或startAbilityForResult()方法，获得返回结果的回调为onAbilityResult()</p></li><li><p>Page Ability的基本概念</p><ul><li>一个Page可以由一个或多个AbilitySlice构成，AbilitySlice是指应用的单个页面及其控制逻辑的总和</li></ul></li><li><p>多个AbilitySlice构成一个Page</p><ul><li>当一个Page由多个AbilitySlice共同构成时，这些AbilitySlice页面提供的业务能力应具有高度相关性</li></ul></li><li><p>AbilitySlice路由配置</p><ul><li>虽然一个Page可以包含多个AbilitySlice，但是Page进入前台时界面默认只能展示一个AbilitySlice。默认展示的AbilitySlice是通过setMainRoute()方法来指定的</li><li>如果需要更改默认展示的AbilitySlice，可以通过addActionRoute()方法为此AbilitySlice配置一条路由规则</li></ul></li><li><p>不同Page间的导航</p><ul><li>不同Page中的AbilitySlice相互不可见，因此无法通过present()或presentForResult()方法直接导航到其他Page的AbilitySlice</li><li>AbilitySlice作为Page的内部单元，以Action的形式对外暴露，因此可以通过配置Intent的Action导航到目标AbilitySlice</li></ul></li></ul><h3 id="page与abilityslice的生命周期">Page与AbilitySlice的生命周期</h3><ul><li><p>Page的生命周期</p><ul><li><p>Page的生命周期的不同状态转换及其对应的回调</p></li><li><p>onStart()</p><ul><li>当系统首次创建Page实例时，触发该回调</li><li>对于一个Page实例，该回调在其生命周期过程中仅触发一次，Page在该逻辑后将进入INACTIVE状态</li><li>开发者必须重写该方法，并在此配置默认展示的AbilitySlice</li></ul></li><li><p>onActive()</p><ul><li>Page会在进入INACTIVE状态后来到前台，然后系统调用此回调</li><li>Page在此之后进入ACTIVE状态，该状态是应用与用户交互的状态</li><li>Page在此之后进入ACTIVE状态，该状态是应用与用户交互的状态</li><li>开发者通常需要成对实现onActive()和onInactive()，并在onActive()中获取在onInactive()中被释放的资源</li></ul></li><li><p>onInactive()</p><ul><li>当Page失去焦点时，系统将调用此回调，此后Page进入INACTIVE状态</li></ul></li><li><p>onBackground()</p><ul><li>如果Page不再对用户可见，系统将调用此回调通知开发者用户进行相应的资源释放，此后Page进入BACKGROUND状态</li></ul></li><li><p>onForeground()</p><ul><li>处于BACKGROUND状态的Page仍然驻留在内存中，当重新回到前台时（比如用户重新导航到此Page），系统将先调用onForeground()回调通知开发者，而后Page的生命周期状态回到INACTIVE状态</li></ul></li><li><p>onStop()</p><ul><li><p>系统将要销毁Page时，将会触发此回调函数，通知用户进行系统资源的释放</p></li><li><p>销毁Page的可能原因包括以下几个方面：</p><ul><li>用户通过系统管理能力关闭指定Page，例如使用任务管理器关闭Page</li><li>用户行为触发Page的terminateAbility()方法调用，例如使用应用的退出功能</li><li>配置变更导致系统暂时销毁Page并重建</li><li>系统出于资源管理的目的，自动触发对处于BACKGROUND状态Page的销毁</li></ul></li></ul></li></ul></li><li><p>AbilitySlice的生命周期</p><ul><li>当Page生命周期发生变化时，它的AbilitySlice也会发生相同的生命周期变化</li><li>此外，AbilitySlice还具有独立于Page的生命周期变化，这发生在同一Page中的AbilitySlice之间导航时，此时Page的生命周期状态不会改变</li></ul></li><li><p>Page与AbilitySlice生命周期的关联</p><ul><li>当AbilitySlice处于前台且具有焦点时，其生命周期状态随着所属Page的生命周期状态的变化而变化</li><li>当Page被系统销毁时，其所有已实例化的AbilitySlice将联动销毁，而不仅是处于前台的AbilitySlice</li></ul></li></ul><h3 id="service-ability">Service Ability</h3><ul><li><p>基于Service模板的Ability简称为Service，其主要用于后台运行任务，比如执行音乐播放、文件下载等，但不提供用户交互界面</p></li><li><p>Service是单实例的</p></li><li><p>在一个设备上，相同的Service只会存在一个实例</p></li><li><p>如果多个Ability共用这个实例，只有当与Service绑定的所有Ability都退出后，Service才能够退出</p></li><li><p>由于Service是在主线程里执行的，因此，如果在Service里面的操作时间过长，开发者必须在Service中创建新的线程来处理，防止造成主线程阻塞，应用程序无响应</p></li><li><p>创建Service</p><ul><li><p>继承Ability</p><ul><li><p>每个Service都是Ability的子类</p></li><li><p>Ability为Service提供了以下生命周期方法，用户可以重写这些方法来添加自己的处理</p><ul><li><p>onStart()</p><ul><li>该方法在创建Service的时候调用，用于Service的初始化</li><li>在Service的整个生命周期只会调用一次，调用时传入的Intent应为空</li></ul></li><li><p>onCommand()</p><ul><li>用户可以在该方法中做一些调用统计、初始化类的操作</li></ul></li><li><p>onConnect()</p><ul><li>在Ability和Service连接时调用，该方法返回IRemoteObject对象，用户可以在该回调函数中生成对应Service的IPC通信通道，以便Ability与Service交互</li><li>Ability可以多次连接同一个Service，系统会缓存该Service的IPC通信对象，只有第一个客户端连接Service时，系统才会调用Service的onConnect方法来生成IRemoteObject对象，而后系统会将同一个RemoteObject对象传递至其他连接同一个Service的所有客户端，而无须再次调用onConnect方法</li></ul></li><li><p>onDisconnect()</p><ul><li>在Ability与绑定的Service断开连接时调用</li></ul></li><li><p>onStop()</p><ul><li>在Service销毁时调用</li><li>Service应通过实现此方法来清理任何资源，如关闭线程、注册的侦听器等</li></ul></li></ul></li></ul></li></ul></li><li><p>启动Service</p><ul><li><p>开发者可以通过构造包含DeviceId、BundleName与AbilityName的Operation对象来设置目标Service信息</p><ul><li><p>DeviceId</p><ul><li>表示设备ID</li><li>如果是本地设备，则可以直接留空</li><li>如果是远程设备，则可以通过ohos.distributedschedule.interwork.DeviceManager提供的getDeviceList获取设备列表</li></ul></li><li><p>BundleName</p><ul><li>表示包名称</li></ul></li><li><p>AbilityName</p><ul><li>表示待启动的Ability名称</li></ul></li></ul></li><li><p>如果Service尚未运行，则系统会先调用onStart()来初始化Service，再回调Service的onCommand()方法来启动Service</p></li><li><p>如果Service正在运行，则系统会直接回调Service的onCommand()方法来启动Service</p></li></ul></li><li><p>停止Service</p><ul><li>Service一旦创建就会一直保持在后台运行，除非必须回收内存资源，否则系统不会停止或销毁Service</li><li>可以在Service中通过terminateAbility()来停止本Service，或在其他Ability调用stopAbility()来停止Service</li><li>停止Service同样支持停止本地设备Service和停止远程设备Service，使用方法与启动Service一样</li></ul></li><li><p>连接Service</p><ul><li><p>如果Service需要与Page Ability或其他应用的ServiceAbility进行交互，则应创建用于连接的Connection</p></li><li><p>Service支持其他Ability通过connectAbility()方法与其进行连接</p></li><li><p>需要传入目标Service的Intent与IAbilityConnection的实例</p><ul><li><p>IAbilityConnection提供了两个方法供开发者实现：</p><ul><li>onAbilityConnectDone()用来处理连接的回调</li><li>onAbilityDisconnectDone()用来处理断开连接的回调</li></ul></li></ul></li></ul></li><li><p>Service Ability的生命周期</p><ul><li><p>与Page类似，Service也拥有生命周期</p></li><li><p>根据调用方法的不同，其生命周期有以下两种路径：</p><ul><li><p>启动Service</p><ul><li>该Service在其他Ability调用startAbility()时创建，然后保持运行</li><li>其他Ability通过调用stopAbility()来停止Service，Service停止后，系统会将其销毁</li></ul></li><li><p>连接Service</p><ul><li>该Service在其他Ability调用connectAbility()时创建，客户端可通过调用disconnectAbility()断开连接</li><li>多个客户端可以绑定到相同的Service，而且当所有绑定全部取消后，系统就会销毁该Service</li><li>connectAbility()也可以连接通过startAbility()创建的Service</li></ul></li></ul></li></ul></li></ul><h3 id="data-ability">Data Ability</h3><ul><li><p>使用Data模板的Ability也简称Data</p></li><li><p>主要职责是管理其自身应用和其他应用存储数据的访问，并提供与其他应用共享数据的方法</p></li><li><p>Data既可用于同一设备不同应用的数据共享，也支持跨设备不同应用的数据共享</p></li><li><p>数据的存储方式多种多样，可以是传统意义上的数据库系统，也可以是本地磁盘上的文件</p></li><li><p>Data对外提供对数据的增、删、改、查，以及打开文件等接口，这些接口的具体实现由开发者提供</p></li><li><p>URI</p><ul><li><p>Data的提供方和使用方都通过URI（Uniform ResourceIdentifier，统一资源定位符）来标识一个具体的数据</p></li><li><p>HarmonyOS的URI是基于URI通用标准的，具体格式如图</p><ul><li><p>scheme</p><ul><li>协议方案名，固定为dataability，代表Data Ability所使用的协议类型</li></ul></li><li><p>authority</p><ul><li>设备ID</li><li>如果为跨设备场景，则为目标设备的ID</li><li>如果为本地设备场景，则不需要填写</li></ul></li><li><p>path</p><ul><li>资源的路径信息，代表特定资源的位置信息</li></ul></li><li><p>query</p><ul><li>查询参数</li></ul></li><li><p>fragment</p><ul><li>用于指示要访问的子资源</li></ul></li></ul></li><li><p>URI示例</p><ul><li><p>跨设备场景</p><ul><li>dataability://device_id/com.waylau.hmos.dataabilityhelperaccessfile.dataability.persondata/person/10</li></ul></li><li><p>本地设备</p><ul><li><p>dataability:///com.waylau.hmos.dataabilityhelperaccessfile.dataability.persondata/person/10</p><ul><li>注：本地设备的device_id字段为空，因此在dataability:后面有3个“/”</li></ul></li></ul></li></ul></li></ul></li><li><p>访问Data</p><ul><li><p>DataAbilityHelper为开发者提供了一系列的接口来访问不同类型的数据，比如文件、数据库等</p></li><li><p>访问文件</p><ul><li><p>DataAbilityHelper为开发者提供了FileDescriptor openFile（Uri uri,String mode）方法来操作文件</p><ul><li>其中uri用来确定目标资源路径</li><li>mode用来指定打开文件的方式，可选方式包含r（读）、w（写）、rw（读写）、wt（覆盖写）、wa（追加写）、rwt（覆盖写且可读）</li></ul></li><li><p>该方法返回一个目标文件的FD（文件描述符），把文件描述符封装成流，开发者就可以对文件流进行自定义处理</p></li></ul></li><li><p>访问数据库</p><ul><li>DataAbilityHelper为开发者提供了增、删、改、查以及批量处理等方法来操作数据库</li></ul></li></ul></li></ul><h3 id="intent">Intent</h3><ul><li><p>在HarmonyOS中，Intent是对象之间传递信息的载体</p></li><li><p>Intent的构成元素包括Operation与Parameters</p></li><li><p>Operation与Parameters</p><ul><li>Operation由表所示的属性组成</li><li>除了上述属性之外，开发者也可以通过Parameters传递某些请求所需的额外信息</li></ul></li><li><p>根据Ability的全称启动应用</p><ul><li>通过构造包含BundleName与AbilityName的Operation对象可以启动一个Ability，并导航到该Ability</li></ul></li></ul><h2 id="第六章-ability任务调度">第六章 Ability任务调度</h2><h3 id="分布式任务调度概述">分布式任务调度概述</h3><ul><li><p>“超级虚拟终端”的能力互助</p><ul><li>分布式任务调度平台是支持“超级虚拟终端”的关键技术和能力，提供针对多设备场景下的统一的组件管理能力</li></ul></li><li><p>跨设备软件访问的系统服务</p></li><li><p>全场景下的任务调度</p></li></ul><h3 id="分布式任务调度能力简介">分布式任务调度能力简介</h3><ul><li><p>全局查询</p><ul><li><p>全局查询可以分为两个维度：针对设备的查询以及针对Ability的查询</p><ul><li>针对设备的查询是指在相同组网下支持查询这个网络下到底有哪些设备，这些设备是在线的还是离线的，这个设备具备哪些Ability，等等</li><li>针对Ability的查询是指查询到底哪些设备支持具体的特定功能</li></ul></li></ul></li><li><p>启动和关闭</p><ul><li>分布式任务调度平台提供了管理远程Ability的能力，即支持启动Page模板的Ability，以及启动、关闭Service和Data模板的Ability</li></ul></li><li><p>连接和断开连接</p><ul><li>在连接到远程设备之后，就可以对设备进行一些列的操作了。操作完成之后，也可以断开连接</li></ul></li><li><p>轻量通信</p><ul><li>轻量通信本质是指从RPC（Remote ProcedureCall，远程过程调用）或者以消息的方式实现设备之间的通信</li></ul></li></ul><h3 id="分布式任务调度实现原理">分布式任务调度实现原理</h3><ul><li><p>PRC</p><ul><li>PRC主要涉及三方面，即接口定义、序列化和反序列化</li><li>要实现PRC，必须要实现IRemoteBroker接口</li><li>同时，需要在本地及对端分别实现对外接口一致的代理</li></ul></li><li><p>HarmonyOS设备之间的通信</p><ul><li>无论是调用本地设备还是远程设备的Ability，HarmonyOS都是通过RemoteObject来实现的</li><li>当初次调用远程设备时，会先通过分布式调度平台获取到远程设备的一个句柄</li><li>在后续的通信过程中，本地设备就可以不必再依赖分布式调度平台而直接通过句柄去跟远程设备进行通信，从而提升通信效率</li></ul></li><li><p>HarmonyOS设备与其他OS设备之间的通信</p><ul><li>HarmonyOS设备与其他OS设备之间无法直接通过句柄去调用，因此分布式调度平台充当了HarmonyOS设备与其他OS设备之间的代理</li><li>所有的通信必须经过分布式调度平台，分布式调度平台会做调用过程中的序列化和反序列化</li><li>因此，从通信效率而言，HarmonyOS设备与其他OS设备之间的通信效率肯定要低于HarmonyOS设备之间的通信</li></ul></li></ul><h3 id="实现分布式任务调度">实现分布式任务调度</h3><ul><li><p>如何实现分布式任务调度</p><ul><li><p>在Intent中设置支持分布式的标记</p><ul><li>例如Intent.FLAG_ABILITYSLICE_MULTI_DEVICE表示该应用支持分布式调度</li></ul></li><li><p>在config.json中的reqPermissions字段中添加多设备协同访问的权限申请</p><ul><li>三方应用使用{"name": "ohos.permission.DISTRIBUTED_DATASYNC"}</li></ul></li><li><p>PA的调用支持连接及断开连接、启动及关闭这4类行为，在进行调度时</p><ul><li>必须在Intent中指定PA对应的bundleName和abilityName</li><li>当需要跨设备启动、关闭或连接PA时，需要在Intent中指定对端设备的deviceId</li><li>可通过如设备管理类DeviceManager提供的getDeviceList获取指定条件下匿名化处理的设备列表，实现对指定设备PA的启动／关闭以及连接管理</li></ul></li><li><p>FA的调用支持启动和迁移行为，在进行调度时</p><ul><li>当启动FA时，需要开发者在Intent中指定对端设备的deviceId、bundleName和abilityName</li><li>FA的迁移实现相同bundleName和abilityName的FA跨设备迁移，因此需要指定迁移设备的deviceId</li></ul></li></ul></li><li><p>分布式任务调度支持的场景</p><ul><li><p>根据Ability模板及意图的不同，分布式任务调度向开发者提供了6种能力：启动远程FA、启动远程PA、关闭远程PA、连接远程PA、断开连接远程PA和FA跨设备迁移</p><ul><li><p>设备A启动设备B的FA</p><ul><li><p>在设备A上通过本地应用提供的启动按钮启动设备B上对应的FA</p><ul><li>例如，设备A控制设备B打开相册，只需开发者在启动FA时指定打开相册的意图即可</li></ul></li></ul></li><li><p>设备A启动设备B的PA</p><ul><li><p>在设备A上通过本地应用提供的启动按钮启动设备B上指定的PA</p><ul><li>例如，开发者在启动远程服务时通过意图指定音乐播放服务，即可实现设备A启动设备B音乐播放的能力</li></ul></li></ul></li><li><p>设备A关闭设备B的PA</p><ul><li><p>在设备A上通过本地应用提供的关闭按钮关闭设备B上指定的PA</p><ul><li>类似启动的过程，开发者在关闭远程服务时通过意图指定音乐播放服务，即可实现关闭设备B上该服务的能力</li></ul></li></ul></li><li><p>设备A连接设备B的PA</p><ul><li><p>在设备A上通过本地应用提供的连接按钮连接设备B上指定的PA</p><ul><li>连接后，通过其他功能相关按钮实现控制对端PA的能力</li><li>通过连接关系，开发者可以实现跨设备的同步服务调度，实现如大型计算任务互助等价值场景</li></ul></li></ul></li><li><p>设备A与设备B的PA断开连接</p><ul><li>在设备A上通过本地应用提供的断开连接的按钮将之前已连接的PA断开连接</li></ul></li><li><p>设备A的FA迁移至设备B</p><ul><li><p>设备A上通过本地应用提供的迁移按钮将设备A的业务无缝迁移到设备B中</p><ul><li>通过业务迁移能力打通设备A和设备B间的壁垒，实现如文档跨设备编辑、视频从客厅到房间跨设备接续播放等场景</li></ul></li></ul></li></ul></li></ul></li></ul><h2 id="第七章-ability公共事件与通知">第七章 Ability公共事件与通知</h2><h3 id="公共事件与通知概述">公共事件与通知概述</h3><ul><li><p>在HarmonyOS里面，系统给应用发送提示一般分为两种方式，即公共事件和通知</p></li><li><p>公共事件和通知</p><ul><li><p>公共事件可分为系统公共事件和自定义公共事件</p><ul><li><p>系统公共事件</p><ul><li>系统将收集到的事件信息根据系统策略发送给订阅该事件的用户程序</li><li>例如用户可感知亮灭屏事件、系统关键服务发送的系统事件（例如USB插拔、网络连接、系统升级等）</li></ul></li><li><p>自定义公共事件</p><ul><li>应用自定义公共事件来处理业务逻辑</li></ul></li></ul></li><li><p>IntentAgent封装了一个指定行为的Intent，可以通过IntentAgent启动Ability和发送公共事件</p></li></ul></li><li><p>约束与限制</p><ul><li><p>公共事件的约束与限制</p><ul><li>目前公共事件仅支持动态订阅</li><li>部分系统事件需要具有指定的权限</li><li>目前公共事件订阅不支持多用户</li><li>ThreadMode表示线程模型，目前仅支持HANDLER模式，即在当前UI线程上执行回调函数</li><li>deviceId用来指定订阅本地公共事件还是远端公共事件</li><li>deviceId为null、空字符串或本地设备deviceId时，表示订阅本地公共事件，否则表示订阅远端公共事件</li></ul></li><li><p>通知的约束与限制</p><ul><li>通知目前支持6种样式：普通文本、长文本、图片、社交、多行文本和媒体样式</li><li>创建通知时必须包含其中一种样式</li><li>通知支持快捷回复</li></ul></li><li><p>IntentAgent的限制</p><ul><li>使用IntentAgent启动Ability时，Intent必须指定Ability的包名和类名</li></ul></li></ul></li></ul><h3 id="公共事件服务">公共事件服务</h3><ul><li><p>发送公共事件需要借助CommonEventData对象，接收公共事件需要继承CommonEventSubscriber类并实现onReceiveEvent回调函数</p></li><li><p>接口说明</p><ul><li><p>CommonEventData</p><ul><li><p>CommonEventData封装公共事件相关信息，用于在发布、分发和接收时处理数据</p><ul><li>code为有序公共事件的结果码，data为有序公共事件的结果数据，仅用于有序公共事件场景</li><li>intent不允许为空，否则发布公共事件失败</li></ul></li></ul></li><li><p>CommonEventPublishInfo</p><ul><li><p>CommonEventPublishInfo封装公共事件发布相关属性、限制等信息，包括公共事件类型（有序或粘性）、接收者权限等</p><ul><li><p>有序公共事件</p><ul><li>主要场景是多个订阅者有依赖关系或者对处理顺序有要求</li><li>高优先级订阅者可修改公共事件内容或处理结果，包括终止公共事件处理</li><li>低优先级订阅者依赖高优先级的处理结果等</li><li>有序公共事件的订阅者可以通过CommonEventSubscribeInfo.setPriority()方法指定优先级，默认为0，优先级范围为[-1000,1000]，值越大优先级越高</li></ul></li><li><p>粘性公共事件</p><ul><li>指公共事件的订阅动作是在公共事件发布之后进行的，订阅者也能收到的公共事件类型</li><li>主要场景是由公共事件服务记录某些系统状态，如蓝牙、WLAN、充电等事件和状态</li><li>不使用粘性公共事件机制时，应用可以通过直接访问系统服务获取该状态</li><li>发布粘性公共事件可以通过setSticky()方法设置，发布粘性公共事件需要申请ohos.permission.COMMONEVENT_STICKY权限</li></ul></li></ul></li></ul></li><li><p>CommonEventSubscribeInfo</p><ul><li><p>CommonEventSubscribeInfo封装公共事件订阅相关信息，比如优先级、线程模式、事件范围等</p><ul><li><p>线程模式</p><ul><li>HANDLER：在Ability的主线程执行</li><li>POST：在事件分发线程执行</li><li>ASYNC：在一个新创建的异步线程执行</li><li>BACKGROUND：在后台线程执行</li><li>截至目前只支持HANDLER模式</li></ul></li></ul></li></ul></li><li><p>CommonEventSubscriber</p><ul><li><p>CommonEventSubscriber封装公共事件订阅者及相关参数</p><ul><li>CommonEventSubscriber.AsyncCommonEventResult类处理有序公共事件异步执行</li><li>目前只能通过调用CommonEventManager的subscribeCommonEvent()进行订阅</li></ul></li></ul></li><li><p>CommonEventManager</p><ul><li><p>CommonEventManager是为应用提供订阅、退订和发布公共事件的静态接口类</p><ul><li>发布公共事件：publishCommonEvent(CommonEventData event)</li><li>发布公共事件指定发布信息：publishCommonEvent(CommonEventData event,CommonEventPublishInfo publishinfo)</li><li>发布有序公共事件，指定发布信息和最后一个接收者：publishCommonEvent(CommonEventDataevent, CommonEventPublishInfo publishinfo, CommonEventSubscriberresultSubscriber)</li><li>订阅公共事件：subscribeCommonEvent(CommonEventSubscribersubscriber)</li><li>退订公共事件：unsubscribeCommonEvent(CommonEventSubscribersubscriber)</li></ul></li></ul></li></ul></li><li><p>发布公共事件</p><ul><li><p>发布无序的公共事件</p><ul><li>发布无序的公共事件时，构造CommonEventData对象，设置Intent，通过构造operation对象把需要发布的公共事件信息传入intent对象</li><li>然后调用 CommonEventManager.publishCommonEvent (CommonEventData)接口发布公共事件</li></ul></li><li><p>发布携带权限的公共事件</p><ul><li>发布携带权限的公共事件时，构造CommonEventPublishInfo对象，设置订阅者的权限</li><li>订阅者在config.json中申请所需的权限，各字段含义详见权限定义字段说明</li></ul></li><li><p>发布有序的公共事件</p><ul><li>发布有序的公共事件时，构造CommonEventPublishInfo对象，通过setOrdered(true)指定公共事件属性为有序公共事件</li><li>也可以指定一个最后的公共事件接收者</li></ul></li><li><p>发布粘性公共事件</p><ul><li>发布粘性公共事件时，构造CommonEventPublishInfo对象，通过setSticky(true)指定公共事件属性为粘性公共事件</li></ul></li></ul></li><li><p>订阅公共事件</p><ul><li>订阅公共事件时，首先创建CommonEventSubscriber派生类，在onReceiveEvent()回调函数中处理公共事件</li><li>注意：此处不能执行耗时操作，否则会阻塞UI线程，产生用户点击没有反应等异常</li></ul></li><li><p>退订公共事件</p><ul><li>在Ability的onStop()中调用CommonEventManager.unsubscribeCommonEvent()方法来退订公共事件</li><li>调用后，之前订阅的所有公共事件均被退订</li></ul></li></ul><h3 id="高级通知服务">高级通知服务</h3><ul><li><p>接口说明</p><ul><li><p>NotificationSlot</p><ul><li><p>NotificationSlot可以对提示音、振动、锁屏显示和重要级别等进行设置</p></li><li><p>一个应用可以创建一个或多个NotificationSlot，在发送通知时，通过绑定不同的NotificationSlot实现不同的用途</p></li><li><p>NotificationSlot需要先通过NotificationHelper的addNotificationSlot(NotificationSlot)方法发布后，通知才能绑定使用</p></li><li><p>所有绑定该NotificationSlot的通知在发布后都具备相应的特性，对象在创建后将无法更改这些设置，对于是否启动相应设置，用户有最终控制权</p></li><li><p>不指定NotificationSlot时，当前通知会使用默认的NotificationSlot，默认的NotificationSlot优先级为LEVEL_DEFAULT</p></li><li><p>NotificationSlot的级别目前支持如下几种，由低到高</p><ul><li><p>LEVEL_NONE：表示通知不发布</p></li><li><p>LEVEL_MIN：表示通知可以发布，但是不显示在通知栏，不自动弹出，无提示音</p><ul><li>该级别不适用于前台服务的场景</li></ul></li><li><p>LEVEL_LOW：表示通知可以发布且显示在通知栏，不自动弹出，无提示音</p></li><li><p>LEVEL_DEFAULT：表示通知发布后可在通知栏显示，不自动弹出，触发提示音</p></li><li><p>LEVEL_HIGH：表示通知发布后可在通知栏显示，自动弹出，触发提示</p></li></ul></li></ul></li><li><p>NotificationRequest</p><ul><li><p>NotificationRequest用于设置具体的通知对象，包括设置通知的属性，如通知的分发时间、小图标、大图标、自动删除等参数，以及设置具体的通知类型，如普通文本、长文本等</p></li><li><p>通知分组：对于同一类型的通知，比如电子邮件，可以放在一个群组内展示</p></li><li><p>小图标、大图标：分别通过NotificationRequest的setLittleIcon(PixelMap)、setBigIcon(PixelMap)设置的小图标、大图标</p></li><li><p>显示时间戳：通知除了显示时间戳外，还可以显示计时器功能，包含正计时和倒计时</p><ul><li>通知通过NotificationRequest的setCreateTime(Long)、setShowCreateTime(boolean)设置并显示时间戳。通知通过NotificationRequest的setShowStopwatch(boolean)显示计时器功能</li><li>通知通过NotificationRequest的setShowStopwatch(boolean)、setCountdownTimer(boolean)显示倒计时功能</li></ul></li><li><p>进度条：主要用于播放音乐、下载等场景</p><ul><li>通知通过NotificationRequest的setProgressBar(int, int,boolean)显示进度条</li></ul></li><li><p>从通知启动Ability：点击通知栏的通知，可以通过启动Ability触发新的事件</p><ul><li>通知通过NotificationRequest的setIntentAgent(IntentAgent)设置IntentAgent后，点击通知栏上发布的通知，将触发通知中的IntentAgent承载的事件</li><li>IntentAgent的设置请参考IntentAgent开发指导</li></ul></li><li><p>通知设置ActionButton：通过点击通知按钮，可以触发按钮承载的事件</p><ul><li>通过NotificationRequest的addActionButton(NotificationActionButton)附加按钮，点击按钮后可以触发相关的事件，具体事件内容如何设置需要参考NotificationActionButton</li></ul></li><li><p>通知设置ComponentProvider：通过ComponentProvider设置自定义的布局</p><ul><li>通过NotificationRequest的setCustomView(ComponentProvider)配置自定义布局，替代系统布局，具体布局信息如何设置需要参考ComponentProvider</li></ul></li><li><p>目前支持6种通知类型，包括</p><ul><li><p>普通文本（NotificationNormalContent）：若为通知的标题，则通过NotificationRequest的setTitle(String)方法设置</p><ul><li>若为通知的内容，则通过NotificationRequest的setText(String)方法设置</li></ul></li><li><p>长文本（NotificationLongTextContent）：长文本的内容通过setLongText(String)设置，文本长度最大支持1024个字符</p></li><li><p>图片（NotificationPictureContent）：具有图片的通知</p></li><li><p>多行（NotificationMultiLineContent）：若为折叠状态下的多行通知样式的标题，则通过NotificationMultiLineContent的setTitle(String)方法设置</p><ul><li>若为折叠状态下的多行通知样式的内容，则通过NotificationMultiLineContent的setText(String)方法设置</li><li>若为展开状态下的多行通知样式的标题，则通过NotificationMultiLineContent的setExpandedTitle(String)方法设置</li><li>若为展开状态下的多行通知样式的内容，则通过NotificationMultiLineContent的addSingleLine(String)方法设置</li></ul></li><li><p>社交（NotificationConversationalContent）：若为社交通知样式的标题，则通过NotificationConversationalContent的setConversationTitle(String)方法设置</p><ul><li>若为社交通知样式中的消息内容，则通过NotificationConversationalContent的addConversationalMessage(ConversationalMessage)方法设置</li></ul></li><li><p>媒体（NotificationMediaContent）：若为媒体通知样式的标题，则通过NotificationMediaContent的setTitle(String)方法设置</p><ul><li>若为媒体通知样式中的消息内容，则通过NotificationMediaContent的setText(String)方法设置</li><li>若为媒体通知样式对应的多媒体按钮，具备控制音频媒体的用途，则通过NotificationMediaContent的setAVToken(AVToken)、NotificationMediaContent的setShownActions(int[])方法设置</li></ul></li></ul></li></ul></li><li><p>NotificationHelper</p><ul><li>NotificationHelper封装了发布、更新、删除通知等静态方法</li><li>发布一条通知：publishNotification(NotificationRequest request)</li><li>发布一条带TAG的通知：publishNotification(String tag,NotificationRequest)</li><li>取消指定的通知：cancelNotification(int notificationId)</li><li>取消指定的带TAG的通知：cancelNotification(String tag, intnotificationId)</li><li>取消之前发布的所有通知：cancelAllNotifications()</li><li>创建一个NotificationSlot：addNotificationSlot(NotificationSlotslot)</li><li>获取NotificationSlo：getNotificationSlot(String slotId)</li><li>删除一个NotificationSlot：removeNotificationSlot(String slotId)</li><li>获取当前应用发布的活跃通知：getActiveNotifications()</li><li>获取系统中当前应用发布的活跃通知的数量：getActiveNotificationNums()</li><li>设置通知的角标：setNotificationBadgeNum(int num)</li><li>设置当前应用中活跃状态通知的数量在角标显示：setNotificationBadgeNum()</li></ul></li></ul></li><li><p>创建NotificationSlot</p><ul><li>NotificationSlot可以设置公共通知的震动、锁屏模式、重要级别等，并通过调用NotificationHelper.addNotificationSlot()发布NotificationSlot对象</li></ul></li><li><p>发布通知</p><ul><li><p>构建NotificationRequest对象</p><ul><li>应用发布通知前，通过NotificationRequest的setSlotId()方法与NotificationSlot绑定，使该通知在发布后具备该对象的特征</li></ul></li><li><p>设置通知内容</p><ul><li>调用setContent()设置通知的内容</li></ul></li><li><p>发送通知</p><ul><li>调用publishNotification()发送通知</li></ul></li></ul></li><li><p>取消通知</p><ul><li><p>取消通知分为取消指定单条通知和取消所有通知，应用只能取消自己发布的通知</p></li><li><p>取消指定的单条通知</p><ul><li>调用cancelNotification()取消指定的单条通知</li></ul></li><li><p>取消所有通知</p><ul><li>调用cancelAllNotifications()取消所有通知</li></ul></li></ul></li></ul><h2 id="第八章-剪切板">第八章 剪切板</h2><h3 id="剪贴板概述">剪贴板概述</h3><ul><li>提供系统剪贴板服务的操作接口，支持用户程序从系统剪贴板中读取、写入和查询剪贴板数据，以及添加、移除系统剪贴板数据变化的回调</li><li>提供剪贴板数据的对象定义，包含内容对象和属性对象</li></ul><h3 id="场景介绍">场景介绍</h3><ul><li><p>同一设备的应用程序A、B之间可以借助系统剪贴板服务完成简单数据的传递</p></li><li><p>在使用剪贴板服务时，需要注意以下几点</p><ul><li>只有在前台获取到焦点的应用才有读取系统剪贴板的权限（系统默认输入法应用除外）</li><li>写入剪贴板服务中的剪贴板数据不会随应用程序的结束而销毁</li><li>对同一用户而言，写入剪贴板服务的数据会被下一次写入剪贴板的数据所覆盖</li><li>在同一设备内，剪贴板单次传递的内容不应超过500KB</li></ul></li></ul><h3 id="接口说明">接口说明</h3><ul><li><p>在HarmonyOS中，SystemPasteboard提供系统剪贴板操作的相关接口，比如复制、粘贴、配置回调等</p><ul><li>PasteData是剪贴板服务操作的数据对象，一个PasteData由若干个内容节点（PasteData.Record）和一个属性集合对象（PasteData.DataProperty）组成</li><li>Record是存放剪贴板数据内容信息的最小单位，每个Record都有其特定的MIME类型，如纯文本、HTML、URI、Intent</li><li>剪贴板数据的属性信息存放在DataProperty中，包括标签、时间戳等</li></ul></li><li><p>SystemPasteboard</p><ul><li><p>SystemPasteboard提供系统剪贴板服务的操作接口，比如复制、粘贴、配置回调等</p></li><li><p>SystemPasteboard的主要接口如下</p><ul><li>获取系统剪贴板服务的对象实例：getSystemPasteboard(Contextcontext)</li><li>读取当前系统剪贴板中的数据：getPasteData()</li><li>判断当前系统剪贴板中是否有内容：hasPasteData()</li><li>将剪贴板数据写入系统剪贴板：setPasteData(PasteData data)</li><li>清空系统剪贴板数据：clear()</li><li>用户程序添加系统剪贴板数据变化的回调：addPasteDataChangedListener(IPasteDataChangedListener listener)</li><li>用户程序移除系统剪贴板数据变化的回调：removePasteDataChangedListener(IPasteData-ChangedListenerlistener)</li></ul></li></ul></li><li><p>PasteData</p><ul><li><p>PasteData是剪贴板服务操作的数据对象，其中内容节点定义为PasteData.Record，属性集合定义为PasteData.DataProperty</p></li><li><p>PasteData的主要接口如下</p><ul><li>构造器：PasteData()</li><li>构建一个包含纯文本内容节点的数据对象：createPlainTextData(CharSequencetext)</li><li>构建一个包含HTML内容节点的数据对象：creatHtmlData(StringhtmlText)</li><li>构建一个包含URI内容节点的数据对象：creatUriData(Uri uri)</li><li>构建一个包含Intent内容节点的数据对象：creatIntentData(Intentintent)</li><li>获取数据对象中首个内容节点的MIME类型：getPrimaryMimeType()</li><li>获取数据对象中首个内容节点的纯文本内容：getPrimaryText()</li><li>向数据对象中添加一个纯文本内容节点：addTextRecord(CharSequencetext)</li><li>向数据对象中添加一个内容节点：addRecord(Record record)</li><li>获取数据对象中内容节点的数量：getRecordCount()</li><li>获取数据对象在指定下标处的内容节点：getRecordAt(int index)</li><li>移除数据对象在指定下标处的内容节点：removeRecordAt(int index)</li><li>获取数据对象中所有内容节点的MIME类型列表：getMimeTypes()</li><li>获取该数据对象的属性集合成员：getProperty()</li></ul></li></ul></li><li><p>PasteData.Record</p><ul><li><p>一个PasteData中包含若干个特定MIME类型的PasteData.Record，每个Record是存放剪贴板数据内容信息的最小单位</p></li><li><p>PasteData.Record的主要接口如下</p><ul><li>构造一个MIME类型为纯文本的内容节点：createPlainTextRecord(CharSequencetext)</li><li>构造一个MIME类型为HTML的内容节点：createHtmlTextRecord(StringhtmlText)</li><li>构造一个MIME类型为URI的内容节点：createUriRecord(Uri uri)</li><li>构造一个MIME类型为Intent的内容节点：createIntentRecord(Intentintent)</li><li>获取该内容节点中的文本内容：getPlainText()</li><li>获取该内容节点中的HTML内容：getHtmlText()</li><li>获取该内容节点中的URI内容：getUri()</li><li>获取该内容节点中的Intent内容：getIntent()</li><li>获取该内容节点的MIME类型：getMimeType()</li><li>将该内容节点的内容转为文本形式：convertToText(Context context)</li></ul></li></ul></li><li><p>PasteData.DataProperty</p><ul><li><p>每个PasteData中都有一个PasteData.DataProperty成员，其中存放着该数据对象的属性集合，例如自定义标签、MIME类型集合列表等</p></li><li><p>PasteData.DataProperty的主要接口如下</p><ul><li>获取所属数据对象的MIME类型集合列表：getMimeTypes()</li><li>判断所属数据对象中是否包含特定MIME类型的内容：hasMimeType(StringmimeType)</li><li>获取所属数据对象被写入系统剪贴板时的时间戳：getTimestamp()</li><li>设置自定义标签：setTag(CharSequence tag)</li><li>获取自定义标签：getTag()</li><li>设置一些附加键值对信息：setAdditions(PacMap extraProps)</li><li>获取附加键值对信息：getAdditions()</li></ul></li></ul></li><li><p>IPasteDataChangedListener</p><ul><li>IPasteDataChangedListener是定义剪贴板数据变化回调的接口类，开发者需要实现此接口来编码触发回调时的处理逻辑</li><li>IPasteDataChangedListener的主要接口是onChanged()，这个是当系统剪贴板数据发生变化时的回调接口</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>开发文档</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArkTs</tag>
      
      <tag>HarmonyOS</tag>
      
      <tag>应用开发</tag>
      
      <tag>博海拾贝</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>考研数学第一版</title>
    <link href="/2024/05/02/graduateSchoolMathematicsPdf/"/>
    <url>/2024/05/02/graduateSchoolMathematicsPdf/</url>
    
    <content type="html"><![CDATA[<div class="row">    <embed src="./PostgraduateMathematicsPreview.pdf" width="100%" height="550" type="application/pdf"></div><p>(考研数学预览版)</p>]]></content>
    
    
    <categories>
      
      <category>在线 PDF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>高等数学</tag>
      
      <tag>考研数学</tag>
      
      <tag>数学</tag>
      
      <tag>线性代数</tag>
      
      <tag>概率论与数理统计</tag>
      
      <tag>LaTeX</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
